.PHONY: intfiles

all: intfiles

INTFILES_RAW=\
	FStar_Int8.ml		\
	FStar_Int16.ml		\
	FStar_Int32.ml		\
	FStar_Int64.ml		\
	FStar_UInt16.ml		\
	FStar_UInt32.ml		\
	FStar_UInt64.ml

FSTAR_HOME ?= $(realpath ../..)

include $(FSTAR_HOME)/.common.mk

DUNE_SNAPSHOT ?= $(call maybe_cygwin_path,$(FSTAR_HOME)/ocaml)

TARGET_DIR=$(FSTAR_HOME)/src/ocaml-output/fstarlib/
INTFILES=$(addprefix $(TARGET_DIR),$(INTFILES_RAW))

intfiles: $(INTFILES)

$(TARGET_DIR)%.ml: %.ml.prefix FStar_Ints.ml.body $(TARGET_DIR)
	$(Q)>$@
	$(Q)echo '(* !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *)' >> $@
	$(Q)echo '(* THIS IS AN AUTOGENERATED FILE! See ulib/ml/Makefile *)' >> $@
	$(Q)echo '(* !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *)' >> $@
	$(Q)echo '' >> $@
	$(Q)cat $< FStar_Ints.ml.body >> $@

$(TARGET_DIR):
	mkdir -p $@
