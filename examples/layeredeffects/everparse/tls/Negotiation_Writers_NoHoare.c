/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
 */

#include "Negotiation_Writers_NoHoare.h"

typedef struct iresult__LowParseWriters_rptr_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      LowParseWriters_rptr res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__LowParseWriters_rptr;

#define Correct 0
#define Error 1

typedef uint8_t result__LowParseWriters_rptr_tags;

typedef struct result__LowParseWriters_rptr_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    LowParseWriters_rptr case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__LowParseWriters_rptr;

typedef struct iresult__Parsers_CipherSuite13_cipherSuite13_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      Parsers_CipherSuite13_cipherSuite13 res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__Parsers_CipherSuite13_cipherSuite13;

typedef struct result__Parsers_CipherSuite13_cipherSuite13_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    Parsers_CipherSuite13_cipherSuite13 case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__Parsers_CipherSuite13_cipherSuite13;

typedef struct iresult__CipherSuite_cipherSuite__s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      CipherSuite_cipherSuite_ res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__CipherSuite_cipherSuite_;

typedef struct result__CipherSuite_cipherSuite__s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    CipherSuite_cipherSuite_ case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__CipherSuite_cipherSuite_;

typedef struct iresult__uint32_t_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      uint32_t res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__uint32_t;

typedef struct result__uint32_t_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    uint32_t case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__uint32_t;

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_compute_binder(
  LowParseWriters_rptr tc,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  LowParse_Slice_slice sl0 = { .base = tc.rptr_base, .len = tc.rptr_len };
  uint32_t pos1 = Parsers_TicketContents13_accessor_ticketContents13_cs(sl0, (uint32_t)0U);
  uint32_t pos_ = Parsers_CipherSuite13_cipherSuite13_jumper(sl0, pos1);
  uint8_t *b1 = tc.rptr_base + pos1;
  uint32_t len_ = pos_ - pos1;
  uint8_t *b_ = b1;
  uint8_t *base_ = b_;
  uint32_t len_0 = len_;
  result__LowParseWriters_rptr
  scrut0 =
    { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_, .rptr_len = len_0 } } };
  result__LowParseWriters_rptr scrut1;
  if (scrut0.tag == Correct)
  {
    LowParseWriters_rptr x = scrut0.val.case_Correct;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut0.tag == Error)
  {
    Prims_string e = scrut0.val.case_Error;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut1 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  result__LowParseWriters_rptr scrut2;
  if (scrut1.tag == Correct)
  {
    LowParseWriters_rptr x = scrut1.val.case_Correct;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut1.tag == Error)
  {
    Prims_string e = scrut1.val.case_Error;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut2 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  iresult__LowParseWriters_rptr scrut3;
  if (scrut2.tag == Correct)
  {
    LowParseWriters_rptr res = scrut2.val.case_Correct;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = { .res = res, .new_pos = pos } }
        }
      );
  }
  else if (scrut2.tag == Error)
  {
    Prims_string e = scrut2.val.case_Error;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_IError,
          .val = { .case_IError = e }
        }
      );
  }
  else
  {
    scrut3 =
      KRML_EABORT(iresult__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut3.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut3.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut3.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut3.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut3.val.case_ICorrect.new_pos;
    LowParseWriters_rptr x = scrut3.val.case_ICorrect.res;
    result__Parsers_CipherSuite13_cipherSuite13
    scrut4 =
      {
        .tag = Correct,
        .val = {
          .case_Correct = CipherSuite_cipherSuite13_reader((
              (LowParse_Slice_slice){ .base = x.rptr_base, .len = x.rptr_len }
            ),
            (uint32_t)0U)
        }
      };
    result__Parsers_CipherSuite13_cipherSuite13 scrut5;
    if (scrut4.tag == Correct)
    {
      Parsers_CipherSuite13_cipherSuite13 x1 = scrut4.val.case_Correct;
      scrut5 =
        (
          (result__Parsers_CipherSuite13_cipherSuite13){
            .tag = Correct,
            .val = { .case_Correct = x1 }
          }
        );
    }
    else if (scrut4.tag == Error)
    {
      Prims_string e = scrut4.val.case_Error;
      scrut5 =
        ((result__Parsers_CipherSuite13_cipherSuite13){ .tag = Error, .val = { .case_Error = e } });
    }
    else
    {
      scrut5 =
        KRML_EABORT(result__Parsers_CipherSuite13_cipherSuite13,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    result__Parsers_CipherSuite13_cipherSuite13 scrut6;
    if (scrut5.tag == Correct)
    {
      Parsers_CipherSuite13_cipherSuite13 x1 = scrut5.val.case_Correct;
      scrut6 =
        (
          (result__Parsers_CipherSuite13_cipherSuite13){
            .tag = Correct,
            .val = { .case_Correct = x1 }
          }
        );
    }
    else if (scrut5.tag == Error)
    {
      Prims_string e = scrut5.val.case_Error;
      scrut6 =
        ((result__Parsers_CipherSuite13_cipherSuite13){ .tag = Error, .val = { .case_Error = e } });
    }
    else
    {
      scrut6 =
        KRML_EABORT(result__Parsers_CipherSuite13_cipherSuite13,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    iresult__Parsers_CipherSuite13_cipherSuite13 scrut7;
    if (scrut6.tag == Correct)
    {
      Parsers_CipherSuite13_cipherSuite13 res = scrut6.val.case_Correct;
      scrut7 =
        (
          (iresult__Parsers_CipherSuite13_cipherSuite13){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = posf } }
          }
        );
    }
    else if (scrut6.tag == Error)
    {
      Prims_string e = scrut6.val.case_Error;
      scrut7 =
        (
          (iresult__Parsers_CipherSuite13_cipherSuite13){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else
    {
      scrut7 =
        KRML_EABORT(iresult__Parsers_CipherSuite13_cipherSuite13,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut7.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut7.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut7.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut7.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut7.val.case_ICorrect.new_pos;
      Parsers_CipherSuite13_cipherSuite13 x1 = scrut7.val.case_ICorrect.res;
      result__CipherSuite_cipherSuite_
      scrut8 =
        { .tag = Correct, .val = { .case_Correct = CipherSuite_cipherSuite_of_cipherSuite13(x1) } };
      result__CipherSuite_cipherSuite_ scrut9;
      if (scrut8.tag == Correct)
      {
        CipherSuite_cipherSuite_ x2 = scrut8.val.case_Correct;
        scrut9 =
          ((result__CipherSuite_cipherSuite_){ .tag = Correct, .val = { .case_Correct = x2 } });
      }
      else if (scrut8.tag == Error)
      {
        Prims_string e = scrut8.val.case_Error;
        scrut9 = ((result__CipherSuite_cipherSuite_){ .tag = Error, .val = { .case_Error = e } });
      }
      else
      {
        scrut9 =
          KRML_EABORT(result__CipherSuite_cipherSuite_,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      iresult__CipherSuite_cipherSuite_ scrut10;
      if (scrut9.tag == Correct)
      {
        CipherSuite_cipherSuite_ res = scrut9.val.case_Correct;
        scrut10 =
          (
            (iresult__CipherSuite_cipherSuite_){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
            }
          );
      }
      else if (scrut9.tag == Error)
      {
        Prims_string e = scrut9.val.case_Error;
        scrut10 =
          (
            (iresult__CipherSuite_cipherSuite_){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut10 =
          KRML_EABORT(iresult__CipherSuite_cipherSuite_,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut10.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut10.val.case_IError;
        return
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut10.tag == LowParseWriters_IOverflow)
      {
        return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut10.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut10.val.case_ICorrect.new_pos;
        CipherSuite_cipherSuite_ x2 = scrut10.val.case_ICorrect.res;
        if (x2.tag == CipherSuite_CipherSuite13)
        {
          Spec_Hash_Definitions_hash_alg h = x2.val.case_CipherSuite13._1;
          uint32_t sw;
          switch (h)
          {
            case Spec_Hash_Definitions_MD5:
              {
                sw = (uint32_t)16U;
                break;
              }
            case Spec_Hash_Definitions_SHA1:
              {
                sw = (uint32_t)20U;
                break;
              }
            case Spec_Hash_Definitions_SHA2_224:
              {
                sw = (uint32_t)28U;
                break;
              }
            case Spec_Hash_Definitions_SHA2_256:
              {
                sw = (uint32_t)32U;
                break;
              }
            case Spec_Hash_Definitions_SHA2_384:
              {
                sw = (uint32_t)48U;
                break;
              }
            case Spec_Hash_Definitions_SHA2_512:
              {
                sw = (uint32_t)64U;
                break;
              }
            default:
              {
                KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
                KRML_HOST_EXIT(253U);
              }
          }
          result__uint32_t scrut11 = { .tag = Correct, .val = { .case_Correct = sw } };
          result__uint32_t scrut12;
          if (scrut11.tag == Correct)
          {
            uint32_t x3 = scrut11.val.case_Correct;
            scrut12 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x3 } });
          }
          else if (scrut11.tag == Error)
          {
            Prims_string e = scrut11.val.case_Error;
            scrut12 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
          }
          else
          {
            scrut12 =
              KRML_EABORT(result__uint32_t,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          iresult__uint32_t scrut;
          if (scrut12.tag == Correct)
          {
            uint32_t res = scrut12.val.case_Correct;
            scrut =
              (
                (iresult__uint32_t){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = { .res = res, .new_pos = posf2 } }
                }
              );
          }
          else if (scrut12.tag == Error)
          {
            Prims_string e = scrut12.val.case_Error;
            scrut =
              ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
          }
          else
          {
            scrut =
              KRML_EABORT(iresult__uint32_t,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut.val.case_IError;
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut.tag == LowParseWriters_IOverflow)
          {
            return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut.tag == LowParseWriters_ICorrect)
          {
            uint32_t x3 = scrut.val.case_ICorrect.res;
            uint32_t ilen = (uint32_t)1U;
            if (len < ilen || len - ilen < x3)
            {
              return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else
            {
              LowParse_Slice_slice sl = { .base = buf, .len = len };
              sl.base[0U] = (uint8_t)x3;
              uint32_t len1 = (uint32_t)1U;
              uint32_t uu____0 = (uint32_t)0U + len1;
              uint8_t *b_pl = buf + ilen;
              memset(b_pl, 0U, x3 * sizeof (b_pl[0U]));
              return
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = ilen + x3 }
                  }
                );
            }
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
        else
        {
          KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
            __FILE__,
            __LINE__,
            "unreachable (pattern matches are exhaustive in F*)");
          KRML_HOST_EXIT(255U);
        }
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_obfuscate_age(
  uint32_t now,
  LowParseWriters_rptr ri,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  LowParse_Slice_slice sl0 = { .base = ri.rptr_base, .len = ri.rptr_len };
  uint32_t pos10 = Parsers_ResumeInfo13_accessor_resumeInfo13_identity(sl0, (uint32_t)0U);
  uint32_t pos_ = Parsers_PskIdentity_identity_pskIdentity_identity_jumper(sl0, pos10);
  uint8_t *b10 = ri.rptr_base + pos10;
  uint32_t len_ = pos_ - pos10;
  uint8_t *b_ = b10;
  uint8_t *base_ = b_;
  uint32_t len_0 = len_;
  result__LowParseWriters_rptr
  scrut0 =
    { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_, .rptr_len = len_0 } } };
  result__LowParseWriters_rptr scrut1;
  if (scrut0.tag == Correct)
  {
    LowParseWriters_rptr x = scrut0.val.case_Correct;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut0.tag == Error)
  {
    Prims_string e = scrut0.val.case_Error;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut1 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  result__LowParseWriters_rptr scrut2;
  if (scrut1.tag == Correct)
  {
    LowParseWriters_rptr x = scrut1.val.case_Correct;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut1.tag == Error)
  {
    Prims_string e = scrut1.val.case_Error;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut2 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  iresult__LowParseWriters_rptr scrut3;
  if (scrut2.tag == Correct)
  {
    LowParseWriters_rptr res = scrut2.val.case_Correct;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = { .res = res, .new_pos = pos } }
        }
      );
  }
  else if (scrut2.tag == Error)
  {
    Prims_string e = scrut2.val.case_Error;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_IError,
          .val = { .case_IError = e }
        }
      );
  }
  else
  {
    scrut3 =
      KRML_EABORT(iresult__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut3.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut3.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut3.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut3.tag == LowParseWriters_ICorrect)
  {
    LowParseWriters_rptr x = scrut3.val.case_ICorrect.res;
    LowParseWriters_iresult____ scrut4;
    if (len < x.rptr_len)
    {
      scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else
    {
      memcpy(buf, x.rptr_base, x.rptr_len * sizeof (x.rptr_base[0U]));
      scrut4 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = x.rptr_len }
          }
        );
    }
    if (scrut4.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut4.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut4.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut4.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut4.val.case_ICorrect;
      LowParse_Slice_slice sl1 = { .base = ri.rptr_base, .len = ri.rptr_len };
      uint32_t pos1 = Parsers_ResumeInfo13_accessor_resumeInfo13_ticket(sl1, (uint32_t)0U);
      uint32_t pos_0 = Parsers_TicketContents13_ticketContents13_jumper(sl1, pos1);
      uint8_t *b11 = ri.rptr_base + pos1;
      uint32_t len_1 = pos_0 - pos1;
      uint8_t *b_0 = b11;
      uint8_t *base_0 = b_0;
      uint32_t len_2 = len_1;
      result__LowParseWriters_rptr
      scrut5 =
        { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_0, .rptr_len = len_2 } } };
      result__LowParseWriters_rptr scrut6;
      if (scrut5.tag == Correct)
      {
        LowParseWriters_rptr x2 = scrut5.val.case_Correct;
        scrut6 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x2 } });
      }
      else if (scrut5.tag == Error)
      {
        Prims_string e = scrut5.val.case_Error;
        scrut6 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
      }
      else
      {
        scrut6 =
          KRML_EABORT(result__LowParseWriters_rptr,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      result__LowParseWriters_rptr scrut7;
      if (scrut6.tag == Correct)
      {
        LowParseWriters_rptr x2 = scrut6.val.case_Correct;
        scrut7 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x2 } });
      }
      else if (scrut6.tag == Error)
      {
        Prims_string e = scrut6.val.case_Error;
        scrut7 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
      }
      else
      {
        scrut7 =
          KRML_EABORT(result__LowParseWriters_rptr,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      iresult__LowParseWriters_rptr scrut8;
      if (scrut7.tag == Correct)
      {
        LowParseWriters_rptr res = scrut7.val.case_Correct;
        scrut8 =
          (
            (iresult__LowParseWriters_rptr){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
            }
          );
      }
      else if (scrut7.tag == Error)
      {
        Prims_string e = scrut7.val.case_Error;
        scrut8 =
          (
            (iresult__LowParseWriters_rptr){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut8 =
          KRML_EABORT(iresult__LowParseWriters_rptr,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut8.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut8.val.case_IError;
        return
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut8.tag == LowParseWriters_IOverflow)
      {
        return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut8.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut8.val.case_ICorrect.new_pos;
        LowParseWriters_rptr x2 = scrut8.val.case_ICorrect.res;
        LowParse_Slice_slice sl2 = { .base = x2.rptr_base, .len = x2.rptr_len };
        uint32_t
        pos11 = Parsers_TicketContents13_accessor_ticketContents13_creation_time(sl2, (uint32_t)0U);
        uint32_t pos_1 = pos11 + (uint32_t)4U;
        uint8_t *b12 = x2.rptr_base + pos11;
        uint32_t len_3 = pos_1 - pos11;
        uint8_t *b_1 = b12;
        uint8_t *base_1 = b_1;
        uint32_t len_4 = len_3;
        result__LowParseWriters_rptr
        scrut9 =
          { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_1, .rptr_len = len_4 } } };
        result__LowParseWriters_rptr scrut10;
        if (scrut9.tag == Correct)
        {
          LowParseWriters_rptr x3 = scrut9.val.case_Correct;
          scrut10 =
            ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x3 } });
        }
        else if (scrut9.tag == Error)
        {
          Prims_string e = scrut9.val.case_Error;
          scrut10 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
        }
        else
        {
          scrut10 =
            KRML_EABORT(result__LowParseWriters_rptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        result__LowParseWriters_rptr scrut11;
        if (scrut10.tag == Correct)
        {
          LowParseWriters_rptr x3 = scrut10.val.case_Correct;
          scrut11 =
            ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x3 } });
        }
        else if (scrut10.tag == Error)
        {
          Prims_string e = scrut10.val.case_Error;
          scrut11 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
        }
        else
        {
          scrut11 =
            KRML_EABORT(result__LowParseWriters_rptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__LowParseWriters_rptr scrut12;
        if (scrut11.tag == Correct)
        {
          LowParseWriters_rptr res = scrut11.val.case_Correct;
          scrut12 =
            (
              (iresult__LowParseWriters_rptr){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = { .res = res, .new_pos = posf2 } }
              }
            );
        }
        else if (scrut11.tag == Error)
        {
          Prims_string e = scrut11.val.case_Error;
          scrut12 =
            (
              (iresult__LowParseWriters_rptr){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else
        {
          scrut12 =
            KRML_EABORT(iresult__LowParseWriters_rptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut12.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut12.val.case_IError;
          return
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut12.tag == LowParseWriters_IOverflow)
        {
          return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut12.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut12.val.case_ICorrect.new_pos;
          LowParseWriters_rptr x3 = scrut12.val.case_ICorrect.res;
          result__uint32_t
          scrut13 = { .tag = Correct, .val = { .case_Correct = load32_be(x3.rptr_base) } };
          result__uint32_t scrut14;
          if (scrut13.tag == Correct)
          {
            uint32_t x4 = scrut13.val.case_Correct;
            scrut14 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x4 } });
          }
          else if (scrut13.tag == Error)
          {
            Prims_string e = scrut13.val.case_Error;
            scrut14 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
          }
          else
          {
            scrut14 =
              KRML_EABORT(result__uint32_t,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          result__uint32_t scrut15;
          if (scrut14.tag == Correct)
          {
            uint32_t x4 = scrut14.val.case_Correct;
            scrut15 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x4 } });
          }
          else if (scrut14.tag == Error)
          {
            Prims_string e = scrut14.val.case_Error;
            scrut15 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
          }
          else
          {
            scrut15 =
              KRML_EABORT(result__uint32_t,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          iresult__uint32_t scrut16;
          if (scrut15.tag == Correct)
          {
            uint32_t res = scrut15.val.case_Correct;
            scrut16 =
              (
                (iresult__uint32_t){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = { .res = res, .new_pos = posf3 } }
                }
              );
          }
          else if (scrut15.tag == Error)
          {
            Prims_string e = scrut15.val.case_Error;
            scrut16 =
              ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
          }
          else
          {
            scrut16 =
              KRML_EABORT(iresult__uint32_t,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut16.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut16.val.case_IError;
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut16.tag == LowParseWriters_IOverflow)
          {
            return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut16.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf4 = scrut16.val.case_ICorrect.new_pos;
            uint32_t x4 = scrut16.val.case_ICorrect.res;
            result__uint32_t
            scrut17 = { .tag = Correct, .val = { .case_Correct = (now - x4) * (uint32_t)1000U } };
            result__uint32_t scrut18;
            if (scrut17.tag == Correct)
            {
              uint32_t x5 = scrut17.val.case_Correct;
              scrut18 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x5 } });
            }
            else if (scrut17.tag == Error)
            {
              Prims_string e = scrut17.val.case_Error;
              scrut18 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
            }
            else
            {
              scrut18 =
                KRML_EABORT(result__uint32_t,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            iresult__uint32_t scrut19;
            if (scrut18.tag == Correct)
            {
              uint32_t res = scrut18.val.case_Correct;
              scrut19 =
                (
                  (iresult__uint32_t){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = { .res = res, .new_pos = posf4 } }
                  }
                );
            }
            else if (scrut18.tag == Error)
            {
              Prims_string e = scrut18.val.case_Error;
              scrut19 =
                ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
            }
            else
            {
              scrut19 =
                KRML_EABORT(iresult__uint32_t,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut19.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut19.val.case_IError;
              return
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut19.tag == LowParseWriters_IOverflow)
            {
              return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut19.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf5 = scrut19.val.case_ICorrect.new_pos;
              uint32_t x5 = scrut19.val.case_ICorrect.res;
              LowParse_Slice_slice sl = { .base = x2.rptr_base, .len = x2.rptr_len };
              uint32_t
              pos12 = Parsers_TicketContents13_accessor_ticketContents13_age_add(sl, (uint32_t)0U);
              uint32_t pos_2 = pos12 + (uint32_t)4U;
              uint8_t *b1 = x2.rptr_base + pos12;
              uint32_t len_5 = pos_2 - pos12;
              uint8_t *b_2 = b1;
              uint8_t *base_2 = b_2;
              uint32_t len_6 = len_5;
              result__LowParseWriters_rptr
              scrut20 =
                {
                  .tag = Correct,
                  .val = { .case_Correct = { .rptr_base = base_2, .rptr_len = len_6 } }
                };
              result__LowParseWriters_rptr scrut21;
              if (scrut20.tag == Correct)
              {
                LowParseWriters_rptr x6 = scrut20.val.case_Correct;
                scrut21 =
                  ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x6 } });
              }
              else if (scrut20.tag == Error)
              {
                Prims_string e = scrut20.val.case_Error;
                scrut21 =
                  ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
              }
              else
              {
                scrut21 =
                  KRML_EABORT(result__LowParseWriters_rptr,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              result__LowParseWriters_rptr scrut22;
              if (scrut21.tag == Correct)
              {
                LowParseWriters_rptr x6 = scrut21.val.case_Correct;
                scrut22 =
                  ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x6 } });
              }
              else if (scrut21.tag == Error)
              {
                Prims_string e = scrut21.val.case_Error;
                scrut22 =
                  ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
              }
              else
              {
                scrut22 =
                  KRML_EABORT(result__LowParseWriters_rptr,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              iresult__LowParseWriters_rptr scrut23;
              if (scrut22.tag == Correct)
              {
                LowParseWriters_rptr res = scrut22.val.case_Correct;
                scrut23 =
                  (
                    (iresult__LowParseWriters_rptr){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = { .res = res, .new_pos = posf5 } }
                    }
                  );
              }
              else if (scrut22.tag == Error)
              {
                Prims_string e = scrut22.val.case_Error;
                scrut23 =
                  (
                    (iresult__LowParseWriters_rptr){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = e }
                    }
                  );
              }
              else
              {
                scrut23 =
                  KRML_EABORT(iresult__LowParseWriters_rptr,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              if (scrut23.tag == LowParseWriters_IError)
              {
                Prims_string e = scrut23.val.case_IError;
                return
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = e }
                    }
                  );
              }
              else if (scrut23.tag == LowParseWriters_IOverflow)
              {
                return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
              }
              else if (scrut23.tag == LowParseWriters_ICorrect)
              {
                uint32_t posf6 = scrut23.val.case_ICorrect.new_pos;
                LowParseWriters_rptr x6 = scrut23.val.case_ICorrect.res;
                result__uint32_t
                scrut24 = { .tag = Correct, .val = { .case_Correct = load32_be(x6.rptr_base) } };
                result__uint32_t scrut25;
                if (scrut24.tag == Correct)
                {
                  uint32_t x7 = scrut24.val.case_Correct;
                  scrut25 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x7 } });
                }
                else if (scrut24.tag == Error)
                {
                  Prims_string e = scrut24.val.case_Error;
                  scrut25 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
                }
                else
                {
                  scrut25 =
                    KRML_EABORT(result__uint32_t,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                result__uint32_t scrut26;
                if (scrut25.tag == Correct)
                {
                  uint32_t x7 = scrut25.val.case_Correct;
                  scrut26 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x7 } });
                }
                else if (scrut25.tag == Error)
                {
                  Prims_string e = scrut25.val.case_Error;
                  scrut26 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
                }
                else
                {
                  scrut26 =
                    KRML_EABORT(result__uint32_t,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                iresult__uint32_t scrut27;
                if (scrut26.tag == Correct)
                {
                  uint32_t res = scrut26.val.case_Correct;
                  scrut27 =
                    (
                      (iresult__uint32_t){
                        .tag = LowParseWriters_ICorrect,
                        .val = { .case_ICorrect = { .res = res, .new_pos = posf6 } }
                      }
                    );
                }
                else if (scrut26.tag == Error)
                {
                  Prims_string e = scrut26.val.case_Error;
                  scrut27 =
                    (
                      (iresult__uint32_t){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else
                {
                  scrut27 =
                    KRML_EABORT(iresult__uint32_t,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut27.tag == LowParseWriters_IError)
                {
                  Prims_string e = scrut27.val.case_IError;
                  return
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else if (scrut27.tag == LowParseWriters_IOverflow)
                {
                  return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                }
                else if (scrut27.tag == LowParseWriters_ICorrect)
                {
                  uint32_t posf7 = scrut27.val.case_ICorrect.new_pos;
                  uint32_t x7 = scrut27.val.case_ICorrect.res;
                  result__uint32_t
                  scrut28 = { .tag = Correct, .val = { .case_Correct = PSK_encode_age(x5, x7) } };
                  result__uint32_t scrut29;
                  if (scrut28.tag == Correct)
                  {
                    uint32_t x8 = scrut28.val.case_Correct;
                    scrut29 = ((result__uint32_t){ .tag = Correct, .val = { .case_Correct = x8 } });
                  }
                  else if (scrut28.tag == Error)
                  {
                    Prims_string e = scrut28.val.case_Error;
                    scrut29 = ((result__uint32_t){ .tag = Error, .val = { .case_Error = e } });
                  }
                  else
                  {
                    scrut29 =
                      KRML_EABORT(result__uint32_t,
                        "unreachable (pattern matches are exhaustive in F*)");
                  }
                  iresult__uint32_t scrut30;
                  if (scrut29.tag == Correct)
                  {
                    uint32_t res = scrut29.val.case_Correct;
                    scrut30 =
                      (
                        (iresult__uint32_t){
                          .tag = LowParseWriters_ICorrect,
                          .val = { .case_ICorrect = { .res = res, .new_pos = posf7 } }
                        }
                      );
                  }
                  else if (scrut29.tag == Error)
                  {
                    Prims_string e = scrut29.val.case_Error;
                    scrut30 =
                      (
                        (iresult__uint32_t){
                          .tag = LowParseWriters_IError,
                          .val = { .case_IError = e }
                        }
                      );
                  }
                  else
                  {
                    scrut30 =
                      KRML_EABORT(iresult__uint32_t,
                        "unreachable (pattern matches are exhaustive in F*)");
                  }
                  if (scrut30.tag == LowParseWriters_IError)
                  {
                    Prims_string e = scrut30.val.case_IError;
                    return
                      (
                        (LowParseWriters_iresult____){
                          .tag = LowParseWriters_IError,
                          .val = { .case_IError = e }
                        }
                      );
                  }
                  else if (scrut30.tag == LowParseWriters_IOverflow)
                  {
                    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                  }
                  else if (scrut30.tag == LowParseWriters_ICorrect)
                  {
                    uint32_t posf8 = scrut30.val.case_ICorrect.new_pos;
                    uint32_t x8 = scrut30.val.case_ICorrect.res;
                    uint8_t *buf_ = buf + posf8;
                    uint8_t *b_3 = buf_;
                    FStar_Pervasives_Native_option__uint32_t scrut31;
                    if (len - posf8 - (uint32_t)0U < (uint32_t)4U)
                    {
                      scrut31 =
                        (
                          (FStar_Pervasives_Native_option__uint32_t){
                            .tag = FStar_Pervasives_Native_None
                          }
                        );
                    }
                    else
                    {
                      store32_be(b_3, x8);
                      uint32_t len1 = (uint32_t)4U;
                      scrut31 =
                        (
                          (FStar_Pervasives_Native_option__uint32_t){
                            .tag = FStar_Pervasives_Native_Some,
                            .v = (uint32_t)0U + len1
                          }
                        );
                    }
                    LowParseWriters_iresult____ scrut32;
                    if (scrut31.tag == FStar_Pervasives_Native_None)
                    {
                      scrut32 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut31.tag == FStar_Pervasives_Native_Some)
                    {
                      uint32_t xlen = scrut31.v;
                      scrut32 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_ICorrect,
                            .val = { .case_ICorrect = (uint32_t)0U + xlen }
                          }
                        );
                    }
                    else
                    {
                      scrut32 =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                    LowParseWriters_iresult____ scrut;
                    if (scrut32.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut32.val.case_IError;
                      scrut =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut32.tag == LowParseWriters_IOverflow)
                    {
                      scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut32.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t wlen = scrut32.val.case_ICorrect;
                      uint32_t pos_3 = posf8 + wlen;
                      scrut =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_ICorrect,
                            .val = { .case_ICorrect = pos_3 }
                          }
                        );
                    }
                    else
                    {
                      scrut =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                    if (scrut.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut.val.case_IError;
                      return
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut.tag == LowParseWriters_IOverflow)
                    {
                      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t posf9 = scrut.val.case_ICorrect;
                      return
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_ICorrect,
                            .val = { .case_ICorrect = posf9 }
                          }
                        );
                    }
                    else
                    {
                      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                        __FILE__,
                        __LINE__,
                        "unreachable (pattern matches are exhaustive in F*)");
                      KRML_HOST_EXIT(255U);
                    }
                  }
                  else
                  {
                    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                      __FILE__,
                      __LINE__,
                      "unreachable (pattern matches are exhaustive in F*)");
                    KRML_HOST_EXIT(255U);
                  }
                }
                else
                {
                  KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                    __FILE__,
                    __LINE__,
                    "unreachable (pattern matches are exhaustive in F*)");
                  KRML_HOST_EXIT(255U);
                }
              }
              else
              {
                KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                  __FILE__,
                  __LINE__,
                  "unreachable (pattern matches are exhaustive in F*)");
                KRML_HOST_EXIT(255U);
              }
            }
            else
            {
              KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                __FILE__,
                __LINE__,
                "unreachable (pattern matches are exhaustive in F*)");
              KRML_HOST_EXIT(255U);
            }
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
        else
        {
          KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
            __FILE__,
            __LINE__,
            "unreachable (pattern matches are exhaustive in F*)");
          KRML_HOST_EXIT(255U);
        }
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_psk_key_exchange_modes(
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint8_t *b_ = buf + pos;
  FStar_Pervasives_Native_option__uint32_t scrut0;
  if (len - pos < (uint32_t)2U)
  {
    scrut0 = ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
  }
  else
  {
    scrut0 =
      (
        (FStar_Pervasives_Native_option__uint32_t){
          .tag = FStar_Pervasives_Native_Some,
          .v = Parsers_ExtensionType_extensionType_writer((
              (Parsers_ExtensionType_extensionType){
                .tag = Parsers_ExtensionType_Psk_key_exchange_modes
              }
            ),
            ((LowParse_Slice_slice){ .base = b_, .len = len - pos }),
            (uint32_t)0U)
        }
      );
  }
  LowParseWriters_iresult____ scrut1;
  if (scrut0.tag == FStar_Pervasives_Native_None)
  {
    scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut0.tag == FStar_Pervasives_Native_Some)
  {
    uint32_t xlen = scrut0.v;
    scrut1 =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos + xlen }
        }
      );
  }
  else
  {
    scrut1 =
      KRML_EABORT(LowParseWriters_iresult____,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut1.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut1.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut1.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut1.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut1.val.case_ICorrect;
    uint8_t *buf_ = buf + posf;
    uint32_t ite0;
    if ((uint32_t)65535U < (uint32_t)256U)
    {
      ite0 = (uint32_t)1U;
    }
    else if ((uint32_t)65535U < (uint32_t)65536U)
    {
      ite0 = (uint32_t)2U;
    }
    else if ((uint32_t)65535U < (uint32_t)16777216U)
    {
      ite0 = (uint32_t)3U;
    }
    else
    {
      ite0 = (uint32_t)4U;
    }
    result__uint32_t scrut2 = { .tag = Correct, .val = { .case_Correct = ite0 } };
    iresult__uint32_t scrut3;
    if (scrut2.tag == Correct)
    {
      uint32_t res = scrut2.val.case_Correct;
      scrut3 =
        (
          (iresult__uint32_t){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = (uint32_t)0U } }
          }
        );
    }
    else if (scrut2.tag == Error)
    {
      Prims_string e = scrut2.val.case_Error;
      scrut3 = ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
    }
    else
    {
      scrut3 = KRML_EABORT(iresult__uint32_t, "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut4;
    if (scrut3.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut3.val.case_IError;
      scrut4 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut3.tag == LowParseWriters_IOverflow)
    {
      scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut3.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut3.val.case_ICorrect.new_pos;
      uint32_t x1 = scrut3.val.case_ICorrect.res;
      uint8_t *b_0 = buf_ + posf1;
      FStar_Pervasives_Native_option__uint32_t (*ite1)(uint8_t *x0, uint32_t x1, uint32_t x2);
      if (Prims_op_GreaterThan(FStar_UInt32_v(x1), (krml_checked_int_t)4294967295))
      {
        ite1 = (void *)0U;
      }
      else
      {
        ite1 = (void *)0U;
      }
      FStar_Pervasives_Native_option__uint32_t scrut5 = ite1(b_0, len - posf - posf1, (uint32_t)0U);
      LowParseWriters_iresult____ scrut6;
      if (scrut5.tag == FStar_Pervasives_Native_None)
      {
        scrut6 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut5.tag == FStar_Pervasives_Native_Some)
      {
        uint32_t xlen = scrut5.v;
        scrut6 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 + xlen }
            }
          );
      }
      else
      {
        scrut6 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut6.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut6.val.case_IError;
        scrut4 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut6.tag == LowParseWriters_IOverflow)
      {
        scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut6.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut6.val.case_ICorrect;
        uint8_t *buf_1 = buf_ + posf2;
        uint32_t pos_pl0 = (uint32_t)1U;
        LowParseWriters_iresult____ scrut7;
        if (len - posf - posf2 < pos_pl0)
        {
          scrut7 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else
        {
          LowParse_Slice_slice sl = { .base = buf_1, .len = len - posf - posf2 };
          sl.base[0U] = (uint8_t)(pos_pl0 - (uint32_t)1U);
          uint32_t len1 = (uint32_t)1U;
          uint32_t uu____0 = (uint32_t)0U + len1;
          scrut7 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = pos_pl0 }
              }
            );
        }
        LowParseWriters_iresult____ scrut8;
        if (scrut7.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut7.val.case_IError;
          scrut8 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut7.tag == LowParseWriters_IOverflow)
        {
          scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut7.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut7.val.case_ICorrect;
          uint8_t *buf_2 = buf_1 + posf3;
          uint8_t *b_1 = buf_2;
          FStar_Pervasives_Native_option__uint32_t scrut9;
          if (len - posf - posf2 - posf3 - (uint32_t)0U < (uint32_t)1U)
          {
            scrut9 =
              ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
          }
          else
          {
            scrut9 =
              (
                (FStar_Pervasives_Native_option__uint32_t){
                  .tag = FStar_Pervasives_Native_Some,
                  .v = Parsers_PskKeyExchangeMode_pskKeyExchangeMode_writer((
                      (Parsers_PskKeyExchangeMode_pskKeyExchangeMode){
                        .tag = Parsers_PskKeyExchangeMode_Psk_ke
                      }
                    ),
                    (
                      (LowParse_Slice_slice){
                        .base = b_1,
                        .len = len - posf - posf2 - posf3 - (uint32_t)0U
                      }
                    ),
                    (uint32_t)0U)
                }
              );
          }
          LowParseWriters_iresult____ scrut10;
          if (scrut9.tag == FStar_Pervasives_Native_None)
          {
            scrut10 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut9.tag == FStar_Pervasives_Native_Some)
          {
            uint32_t xlen = scrut9.v;
            scrut10 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = (uint32_t)0U + xlen }
                }
              );
          }
          else
          {
            scrut10 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          LowParseWriters_iresult____ scrut11;
          if (scrut10.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut10.val.case_IError;
            scrut11 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut10.tag == LowParseWriters_IOverflow)
          {
            scrut11 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut10.tag == LowParseWriters_ICorrect)
          {
            uint32_t wlen = scrut10.val.case_ICorrect;
            uint32_t pos_ = posf3 + wlen;
            scrut11 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = pos_ }
                }
              );
          }
          else
          {
            scrut11 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          LowParseWriters_iresult____ scrut12;
          if (scrut11.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut11.val.case_IError;
            scrut12 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut11.tag == LowParseWriters_IOverflow)
          {
            scrut12 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut11.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf4 = scrut11.val.case_ICorrect;
            LowParse_Slice_slice sl = { .base = buf_1, .len = len - posf - posf2 };
            uint32_t pos_pl = (uint32_t)1U;
            uint32_t sz = posf4 - pos_pl;
            if ((uint32_t)0U <= sz && sz <= (uint32_t)255U)
            {
              sl.base[0U] = (uint8_t)(posf4 - (uint32_t)1U);
              uint32_t len1 = (uint32_t)1U;
              uint32_t uu____1 = (uint32_t)0U + len1;
              scrut12 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = posf4 }
                  }
                );
            }
            else
            {
              scrut12 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                  }
                );
            }
          }
          else
          {
            scrut12 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut12.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut12.val.case_IError;
            scrut8 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut12.tag == LowParseWriters_IOverflow)
          {
            scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut12.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf4 = scrut12.val.case_ICorrect;
            uint8_t *buf_20 = buf_1 + posf4;
            uint8_t *b_2 = buf_20;
            FStar_Pervasives_Native_option__uint32_t scrut13;
            if (len - posf - posf2 - posf4 - (uint32_t)0U < (uint32_t)1U)
            {
              scrut13 =
                ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
            }
            else
            {
              scrut13 =
                (
                  (FStar_Pervasives_Native_option__uint32_t){
                    .tag = FStar_Pervasives_Native_Some,
                    .v = Parsers_PskKeyExchangeMode_pskKeyExchangeMode_writer((
                        (Parsers_PskKeyExchangeMode_pskKeyExchangeMode){
                          .tag = Parsers_PskKeyExchangeMode_Psk_dhe_ke
                        }
                      ),
                      (
                        (LowParse_Slice_slice){
                          .base = b_2,
                          .len = len - posf - posf2 - posf4 - (uint32_t)0U
                        }
                      ),
                      (uint32_t)0U)
                  }
                );
            }
            LowParseWriters_iresult____ scrut14;
            if (scrut13.tag == FStar_Pervasives_Native_None)
            {
              scrut14 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut13.tag == FStar_Pervasives_Native_Some)
            {
              uint32_t xlen = scrut13.v;
              scrut14 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = (uint32_t)0U + xlen }
                  }
                );
            }
            else
            {
              scrut14 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            LowParseWriters_iresult____ scrut15;
            if (scrut14.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut14.val.case_IError;
              scrut15 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut14.tag == LowParseWriters_IOverflow)
            {
              scrut15 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut14.tag == LowParseWriters_ICorrect)
            {
              uint32_t wlen = scrut14.val.case_ICorrect;
              uint32_t pos_ = posf4 + wlen;
              scrut15 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = pos_ }
                  }
                );
            }
            else
            {
              scrut15 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            LowParseWriters_iresult____ scrut16;
            if (scrut15.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut15.val.case_IError;
              scrut16 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut15.tag == LowParseWriters_IOverflow)
            {
              scrut16 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut15.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf5 = scrut15.val.case_ICorrect;
              LowParse_Slice_slice sl = { .base = buf_1, .len = len - posf - posf2 };
              uint32_t pos_pl = (uint32_t)1U;
              uint32_t sz = posf5 - pos_pl;
              if ((uint32_t)0U <= sz && sz <= (uint32_t)255U)
              {
                sl.base[0U] = (uint8_t)(posf5 - (uint32_t)1U);
                uint32_t len1 = (uint32_t)1U;
                uint32_t uu____2 = (uint32_t)0U + len1;
                scrut16 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = posf5 }
                    }
                  );
              }
              else
              {
                scrut16 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                    }
                  );
              }
            }
            else
            {
              scrut16 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut16.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut16.val.case_IError;
              scrut8 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut16.tag == LowParseWriters_IOverflow)
            {
              scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut16.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf5 = scrut16.val.case_ICorrect;
              uint32_t sz = posf5 - (uint32_t)1U;
              LowParseWriters_iresult____ scrut;
              if ((uint32_t)1U <= sz && sz <= (uint32_t)255U)
              {
                scrut =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = posf5 }
                    }
                  );
              }
              else
              {
                scrut =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = "parse_vllist_recast: out of bounds" }
                    }
                  );
              }
              if (scrut.tag == LowParseWriters_IError)
              {
                Prims_string e = scrut.val.case_IError;
                scrut8 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = e }
                    }
                  );
              }
              else if (scrut.tag == LowParseWriters_IOverflow)
              {
                scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
              }
              else if (scrut.tag == LowParseWriters_ICorrect)
              {
                uint32_t posf6 = scrut.val.case_ICorrect;
                scrut8 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = posf6 }
                    }
                  );
              }
              else
              {
                scrut8 =
                  KRML_EABORT(LowParseWriters_iresult____,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
            }
            else
            {
              scrut8 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else
          {
            scrut8 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut8 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        LowParseWriters_iresult____ scrut;
        if (scrut8.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut8.val.case_IError;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut8.tag == LowParseWriters_IOverflow)
        {
          scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut8.tag == LowParseWriters_ICorrect)
        {
          uint32_t wlen = scrut8.val.case_ICorrect;
          uint32_t pos_ = posf2 + wlen;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = pos_ }
              }
            );
        }
        else
        {
          scrut =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut.val.case_IError;
          scrut4 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut.tag == LowParseWriters_IOverflow)
        {
          scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut.val.case_ICorrect;
          LowParse_Slice_slice sl = { .base = buf_, .len = len - posf };
          uint32_t size = posf3 - (uint32_t)2U;
          if ((uint32_t)0U <= size && size <= (uint32_t)65535U)
          {
            uint16_t v_ = (uint16_t)size;
            uint8_t *x0 = sl.base;
            store16_be(x0, v_);
            uint32_t len1 = (uint32_t)2U;
            uint32_t uu____3 = (uint32_t)0U + len1;
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf3 }
                }
              );
          }
          else
          {
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = "parse_vldata_intro_weak: out of bounds" }
                }
              );
          }
        }
        else
        {
          scrut4 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
      }
      else
      {
        scrut4 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut4 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut;
    if (scrut4.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut4.val.case_IError;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut4.tag == LowParseWriters_IOverflow)
    {
      scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut4.tag == LowParseWriters_ICorrect)
    {
      uint32_t wlen = scrut4.val.case_ICorrect;
      uint32_t pos_ = posf + wlen;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = pos_ }
          }
        );
    }
    else
    {
      scrut =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut.val.case_ICorrect;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = posf1 }
          }
        );
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct result_____s
{
  result__LowParseWriters_rptr_tags tag;
  Prims_string _0;
}
result____;

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_clientHelloExtension_CHE_early_data(
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint8_t *b_ = buf + pos;
  FStar_Pervasives_Native_option__uint32_t scrut0;
  if (len - pos < (uint32_t)2U)
  {
    scrut0 = ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
  }
  else
  {
    scrut0 =
      (
        (FStar_Pervasives_Native_option__uint32_t){
          .tag = FStar_Pervasives_Native_Some,
          .v = Parsers_ExtensionType_extensionType_writer((
              (Parsers_ExtensionType_extensionType){ .tag = Parsers_ExtensionType_Early_data }
            ),
            ((LowParse_Slice_slice){ .base = b_, .len = len - pos }),
            (uint32_t)0U)
        }
      );
  }
  LowParseWriters_iresult____ scrut1;
  if (scrut0.tag == FStar_Pervasives_Native_None)
  {
    scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut0.tag == FStar_Pervasives_Native_Some)
  {
    uint32_t xlen = scrut0.v;
    scrut1 =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos + xlen }
        }
      );
  }
  else
  {
    scrut1 =
      KRML_EABORT(LowParseWriters_iresult____,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut1.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut1.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut1.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut1.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut1.val.case_ICorrect;
    uint8_t *buf_ = buf + posf;
    uint32_t ite0;
    if ((uint32_t)65535U < (uint32_t)256U)
    {
      ite0 = (uint32_t)1U;
    }
    else if ((uint32_t)65535U < (uint32_t)65536U)
    {
      ite0 = (uint32_t)2U;
    }
    else if ((uint32_t)65535U < (uint32_t)16777216U)
    {
      ite0 = (uint32_t)3U;
    }
    else
    {
      ite0 = (uint32_t)4U;
    }
    result__uint32_t scrut2 = { .tag = Correct, .val = { .case_Correct = ite0 } };
    iresult__uint32_t scrut3;
    if (scrut2.tag == Correct)
    {
      uint32_t res = scrut2.val.case_Correct;
      scrut3 =
        (
          (iresult__uint32_t){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = (uint32_t)0U } }
          }
        );
    }
    else if (scrut2.tag == Error)
    {
      Prims_string e = scrut2.val.case_Error;
      scrut3 = ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
    }
    else
    {
      scrut3 = KRML_EABORT(iresult__uint32_t, "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut4;
    if (scrut3.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut3.val.case_IError;
      scrut4 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut3.tag == LowParseWriters_IOverflow)
    {
      scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut3.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut3.val.case_ICorrect.new_pos;
      uint32_t x1 = scrut3.val.case_ICorrect.res;
      uint8_t *b_0 = buf_ + posf1;
      FStar_Pervasives_Native_option__uint32_t (*ite1)(uint8_t *x0, uint32_t x1, uint32_t x2);
      if (Prims_op_GreaterThan(FStar_UInt32_v(x1), (krml_checked_int_t)4294967295))
      {
        ite1 = (void *)0U;
      }
      else
      {
        ite1 = (void *)0U;
      }
      FStar_Pervasives_Native_option__uint32_t scrut5 = ite1(b_0, len - posf - posf1, (uint32_t)0U);
      LowParseWriters_iresult____ scrut6;
      if (scrut5.tag == FStar_Pervasives_Native_None)
      {
        scrut6 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut5.tag == FStar_Pervasives_Native_Some)
      {
        uint32_t xlen = scrut5.v;
        scrut6 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 + xlen }
            }
          );
      }
      else
      {
        scrut6 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut6.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut6.val.case_IError;
        scrut4 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut6.tag == LowParseWriters_IOverflow)
      {
        scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut6.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut6.val.case_ICorrect;
        result____ scrut7 = { .tag = Correct };
        result____ scrut8;
        if (scrut7.tag == Correct)
        {
          scrut8 = ((result____){ .tag = Correct });
        }
        else if (scrut7.tag == Error)
        {
          Prims_string e = scrut7._0;
          scrut8 = ((result____){ .tag = Error, ._0 = e });
        }
        else
        {
          scrut8 = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
        }
        LowParseWriters_iresult____ scrut9;
        if (scrut8.tag == Correct)
        {
          scrut9 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = (uint32_t)0U }
              }
            );
        }
        else if (scrut8.tag == Error)
        {
          Prims_string e = scrut8._0;
          scrut9 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else
        {
          scrut9 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        LowParseWriters_iresult____ scrut;
        if (scrut9.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut9.val.case_IError;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut9.tag == LowParseWriters_IOverflow)
        {
          scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut9.tag == LowParseWriters_ICorrect)
        {
          uint32_t wlen = scrut9.val.case_ICorrect;
          uint32_t pos_ = posf2 + wlen;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = pos_ }
              }
            );
        }
        else
        {
          scrut =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut.val.case_IError;
          scrut4 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut.tag == LowParseWriters_IOverflow)
        {
          scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut.val.case_ICorrect;
          LowParse_Slice_slice sl = { .base = buf_, .len = len - posf };
          uint32_t size = posf3 - (uint32_t)2U;
          if ((uint32_t)0U <= size && size <= (uint32_t)65535U)
          {
            uint16_t v_ = (uint16_t)size;
            uint8_t *x0 = sl.base;
            store16_be(x0, v_);
            uint32_t len1 = (uint32_t)2U;
            uint32_t uu____0 = (uint32_t)0U + len1;
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf3 }
                }
              );
          }
          else
          {
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = "parse_vldata_intro_weak: out of bounds" }
                }
              );
          }
        }
        else
        {
          scrut4 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
      }
      else
      {
        scrut4 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut4 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut5;
    if (scrut4.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut4.val.case_IError;
      scrut5 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut4.tag == LowParseWriters_IOverflow)
    {
      scrut5 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut4.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut4.val.case_ICorrect;
      result____ scrut6 = { .tag = Correct };
      result____ scrut;
      if (scrut6.tag == Correct)
      {
        scrut = ((result____){ .tag = Correct });
      }
      else if (scrut6.tag == Error)
      {
        Prims_string e = scrut6._0;
        scrut = ((result____){ .tag = Error, ._0 = e });
      }
      else
      {
        scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut.tag == Correct)
      {
        scrut5 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else if (scrut.tag == Error)
      {
        Prims_string e = scrut._0;
        scrut5 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut5 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut5 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut;
    if (scrut5.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut5.val.case_IError;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut5.tag == LowParseWriters_IOverflow)
    {
      scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut5.tag == LowParseWriters_ICorrect)
    {
      uint32_t wlen = scrut5.val.case_ICorrect;
      uint32_t pos_ = posf + wlen;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = pos_ }
          }
        );
    }
    else
    {
      scrut =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut.val.case_ICorrect;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = posf1 }
          }
        );
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_psk_kex(
  bool allow_psk_resumption,
  bool allow_dhe_resumption,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint8_t *b_ = buf + pos;
  FStar_Pervasives_Native_option__uint32_t scrut0;
  if (len - pos < (uint32_t)2U)
  {
    scrut0 = ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
  }
  else
  {
    scrut0 =
      (
        (FStar_Pervasives_Native_option__uint32_t){
          .tag = FStar_Pervasives_Native_Some,
          .v = Parsers_ExtensionType_extensionType_writer((
              (Parsers_ExtensionType_extensionType){
                .tag = Parsers_ExtensionType_Psk_key_exchange_modes
              }
            ),
            ((LowParse_Slice_slice){ .base = b_, .len = len - pos }),
            (uint32_t)0U)
        }
      );
  }
  LowParseWriters_iresult____ scrut1;
  if (scrut0.tag == FStar_Pervasives_Native_None)
  {
    scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut0.tag == FStar_Pervasives_Native_Some)
  {
    uint32_t xlen = scrut0.v;
    scrut1 =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos + xlen }
        }
      );
  }
  else
  {
    scrut1 =
      KRML_EABORT(LowParseWriters_iresult____,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut1.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut1.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut1.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut1.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut1.val.case_ICorrect;
    uint8_t *buf_ = buf + posf;
    uint32_t ite0;
    if ((uint32_t)65535U < (uint32_t)256U)
    {
      ite0 = (uint32_t)1U;
    }
    else if ((uint32_t)65535U < (uint32_t)65536U)
    {
      ite0 = (uint32_t)2U;
    }
    else if ((uint32_t)65535U < (uint32_t)16777216U)
    {
      ite0 = (uint32_t)3U;
    }
    else
    {
      ite0 = (uint32_t)4U;
    }
    result__uint32_t scrut2 = { .tag = Correct, .val = { .case_Correct = ite0 } };
    iresult__uint32_t scrut3;
    if (scrut2.tag == Correct)
    {
      uint32_t res = scrut2.val.case_Correct;
      scrut3 =
        (
          (iresult__uint32_t){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = (uint32_t)0U } }
          }
        );
    }
    else if (scrut2.tag == Error)
    {
      Prims_string e = scrut2.val.case_Error;
      scrut3 = ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
    }
    else
    {
      scrut3 = KRML_EABORT(iresult__uint32_t, "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut4;
    if (scrut3.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut3.val.case_IError;
      scrut4 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut3.tag == LowParseWriters_IOverflow)
    {
      scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut3.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut3.val.case_ICorrect.new_pos;
      uint32_t x1 = scrut3.val.case_ICorrect.res;
      uint8_t *b_0 = buf_ + posf1;
      FStar_Pervasives_Native_option__uint32_t (*ite1)(uint8_t *x0, uint32_t x1, uint32_t x2);
      if (Prims_op_GreaterThan(FStar_UInt32_v(x1), (krml_checked_int_t)4294967295))
      {
        ite1 = (void *)0U;
      }
      else
      {
        ite1 = (void *)0U;
      }
      FStar_Pervasives_Native_option__uint32_t scrut5 = ite1(b_0, len - posf - posf1, (uint32_t)0U);
      LowParseWriters_iresult____ scrut6;
      if (scrut5.tag == FStar_Pervasives_Native_None)
      {
        scrut6 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut5.tag == FStar_Pervasives_Native_Some)
      {
        uint32_t xlen = scrut5.v;
        scrut6 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 + xlen }
            }
          );
      }
      else
      {
        scrut6 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut6.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut6.val.case_IError;
        scrut4 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut6.tag == LowParseWriters_IOverflow)
      {
        scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut6.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut6.val.case_ICorrect;
        uint8_t *buf_1 = buf_ + posf2;
        uint32_t pos_pl0 = (uint32_t)1U;
        LowParseWriters_iresult____ scrut7;
        if (len - posf - posf2 < pos_pl0)
        {
          scrut7 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else
        {
          LowParse_Slice_slice sl = { .base = buf_1, .len = len - posf - posf2 };
          sl.base[0U] = (uint8_t)(pos_pl0 - (uint32_t)1U);
          uint32_t len1 = (uint32_t)1U;
          uint32_t uu____0 = (uint32_t)0U + len1;
          scrut7 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = pos_pl0 }
              }
            );
        }
        LowParseWriters_iresult____ scrut8;
        if (scrut7.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut7.val.case_IError;
          scrut8 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut7.tag == LowParseWriters_IOverflow)
        {
          scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut7.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut7.val.case_ICorrect;
          LowParseWriters_iresult____ (*ite2)(uint8_t *x0, uint32_t x1, uint32_t x2);
          if (allow_psk_resumption)
          {
            ite2 = (void *)0U;
          }
          else
          {
            ite2 = (void *)0U;
          }
          LowParseWriters_iresult____ scrut9 = ite2(buf_1, len - posf - posf2, posf3);
          if (scrut9.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut9.val.case_IError;
            scrut8 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut9.tag == LowParseWriters_IOverflow)
          {
            scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut9.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf4 = scrut9.val.case_ICorrect;
            LowParseWriters_iresult____ (*ite3)(uint8_t *x0, uint32_t x1, uint32_t x2);
            if (allow_dhe_resumption)
            {
              ite3 = (void *)0U;
            }
            else
            {
              ite3 = (void *)0U;
            }
            LowParseWriters_iresult____ scrut10 = ite3(buf_1, len - posf - posf2, posf4);
            if (scrut10.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut10.val.case_IError;
              scrut8 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut10.tag == LowParseWriters_IOverflow)
            {
              scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut10.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf5 = scrut10.val.case_ICorrect;
              uint32_t sz = posf5 - (uint32_t)1U;
              LowParseWriters_iresult____ scrut11;
              if ((uint32_t)1U <= sz && sz <= (uint32_t)255U)
              {
                scrut11 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = posf5 }
                    }
                  );
              }
              else
              {
                scrut11 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = "parse_vllist_recast: out of bounds" }
                    }
                  );
              }
              if (scrut11.tag == LowParseWriters_IError)
              {
                Prims_string e = scrut11.val.case_IError;
                scrut8 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = e }
                    }
                  );
              }
              else if (scrut11.tag == LowParseWriters_IOverflow)
              {
                scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
              }
              else if (scrut11.tag == LowParseWriters_ICorrect)
              {
                uint32_t posf6 = scrut11.val.case_ICorrect;
                result____ scrut12 = { .tag = Correct };
                result____ scrut;
                if (scrut12.tag == Correct)
                {
                  scrut = ((result____){ .tag = Correct });
                }
                else if (scrut12.tag == Error)
                {
                  Prims_string e = scrut12._0;
                  scrut = ((result____){ .tag = Error, ._0 = e });
                }
                else
                {
                  scrut =
                    KRML_EABORT(result____,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut.tag == Correct)
                {
                  scrut8 =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_ICorrect,
                        .val = { .case_ICorrect = posf6 }
                      }
                    );
                }
                else if (scrut.tag == Error)
                {
                  Prims_string e = scrut._0;
                  scrut8 =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else
                {
                  scrut8 =
                    KRML_EABORT(LowParseWriters_iresult____,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
              }
              else
              {
                scrut8 =
                  KRML_EABORT(LowParseWriters_iresult____,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
            }
            else
            {
              scrut8 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else
          {
            scrut8 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut8 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        LowParseWriters_iresult____ scrut;
        if (scrut8.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut8.val.case_IError;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut8.tag == LowParseWriters_IOverflow)
        {
          scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut8.tag == LowParseWriters_ICorrect)
        {
          uint32_t wlen = scrut8.val.case_ICorrect;
          uint32_t pos_ = posf2 + wlen;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = pos_ }
              }
            );
        }
        else
        {
          scrut =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut.val.case_IError;
          scrut4 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut.tag == LowParseWriters_IOverflow)
        {
          scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut.val.case_ICorrect;
          LowParse_Slice_slice sl = { .base = buf_, .len = len - posf };
          uint32_t size = posf3 - (uint32_t)2U;
          if ((uint32_t)0U <= size && size <= (uint32_t)65535U)
          {
            uint16_t v_ = (uint16_t)size;
            uint8_t *x0 = sl.base;
            store16_be(x0, v_);
            uint32_t len1 = (uint32_t)2U;
            uint32_t uu____3 = (uint32_t)0U + len1;
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf3 }
                }
              );
          }
          else
          {
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = "parse_vldata_intro_weak: out of bounds" }
                }
              );
          }
        }
        else
        {
          scrut4 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
      }
      else
      {
        scrut4 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut4 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut5;
    if (scrut4.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut4.val.case_IError;
      scrut5 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut4.tag == LowParseWriters_IOverflow)
    {
      scrut5 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut4.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut4.val.case_ICorrect;
      result____ scrut6 = { .tag = Correct };
      result____ scrut;
      if (scrut6.tag == Correct)
      {
        scrut = ((result____){ .tag = Correct });
      }
      else if (scrut6.tag == Error)
      {
        Prims_string e = scrut6._0;
        scrut = ((result____){ .tag = Error, ._0 = e });
      }
      else
      {
        scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut.tag == Correct)
      {
        scrut5 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else if (scrut.tag == Error)
      {
        Prims_string e = scrut._0;
        scrut5 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut5 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut5 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut;
    if (scrut5.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut5.val.case_IError;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut5.tag == LowParseWriters_IOverflow)
    {
      scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut5.tag == LowParseWriters_ICorrect)
    {
      uint32_t wlen = scrut5.val.case_ICorrect;
      uint32_t pos_ = posf + wlen;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = pos_ }
          }
        );
    }
    else
    {
      scrut =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut.val.case_ICorrect;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = posf1 }
          }
        );
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct iresult__LowParseWriters_Parsers_rlptr_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      LowParseWriters_Parsers_rlptr res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__LowParseWriters_Parsers_rlptr;

typedef struct __LowParseWriters_Parsers_rlptr_bool_s
{
  LowParseWriters_Parsers_rlptr fst;
  bool snd;
}
__LowParseWriters_Parsers_rlptr_bool;

typedef struct iresult__K___LowParseWriters_Parsers_rlptr_bool_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      __LowParseWriters_Parsers_rlptr_bool res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__K___LowParseWriters_Parsers_rlptr_bool;

typedef struct __LowParseWriters_rptr_LowParseWriters_Parsers_rlptr_s
{
  LowParseWriters_rptr fst;
  LowParseWriters_Parsers_rlptr snd;
}
__LowParseWriters_rptr_LowParseWriters_Parsers_rlptr;

typedef struct option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr_s
{
  FStar_Pervasives_Native_option__Prims_string_tags tag;
  __LowParseWriters_rptr_LowParseWriters_Parsers_rlptr v;
}
option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr;

typedef struct
iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr;

typedef struct
result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr;

typedef struct result__K___LowParseWriters_Parsers_rlptr_bool_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    __LowParseWriters_Parsers_rlptr_bool case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__K___LowParseWriters_Parsers_rlptr_bool;

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_binders(
  LowParseWriters_Parsers_rlptr lri,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint32_t pos_pl = (uint32_t)2U;
  LowParseWriters_iresult____ scrut0;
  if (len < pos_pl)
  {
    scrut0 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else
  {
    LowParse_Slice_slice sl = { .base = buf, .len = len };
    uint16_t v_ = (uint16_t)(pos_pl - (uint32_t)2U);
    uint8_t *x0 = sl.base;
    store16_be(x0, v_);
    uint32_t len1 = (uint32_t)2U;
    uint32_t uu____0 = (uint32_t)0U + len1;
    scrut0 =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos_pl }
        }
      );
  }
  LowParseWriters_iresult____ scrut1;
  if (scrut0.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut0.val.case_IError;
    scrut1 =
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut0.tag == LowParseWriters_IOverflow)
  {
    scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut0.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut0.val.case_ICorrect;
    iresult__LowParseWriters_Parsers_rlptr
    btemp =
      {
        .tag = LowParseWriters_ICorrect,
        .val = { .case_ICorrect = { .res = lri, .new_pos = posf } }
      };
    while (true)
    {
      iresult__LowParseWriters_Parsers_rlptr scrut2 = btemp;
      bool ite0;
      if (scrut2.tag == LowParseWriters_ICorrect)
      {
        uint32_t pos1 = scrut2.val.case_ICorrect.new_pos;
        LowParseWriters_Parsers_rlptr x1 = scrut2.val.case_ICorrect.res;
        uint8_t *base = x1.rlptr_base;
        uint32_t len1 = x1.rlptr_len;
        LowParse_Slice_slice sl0 = { .base = base, .len = len1 };
        result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut3;
        if (x1.rlptr_len == (uint32_t)0U)
        {
          scrut3 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
              }
            );
        }
        else
        {
          uint32_t pos2 = Parsers_ResumeInfo13_resumeInfo13_jumper(sl0, (uint32_t)0U);
          uint8_t *b_hd = base;
          uint32_t len_tl = len1 - pos2;
          uint8_t *b_tl = base + pos2;
          scrut3 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = {
                  .case_Correct = {
                    .tag = FStar_Pervasives_Native_Some,
                    .v = {
                      .fst = { .rptr_base = b_hd, .rptr_len = pos2 },
                      .snd = { .rlptr_base = b_tl, .rlptr_len = len_tl }
                    }
                  }
                }
              }
            );
        }
        result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut4;
        if (scrut3.tag == Correct)
        {
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          x2 = scrut3.val.case_Correct;
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr ite;
          if (x2.tag == FStar_Pervasives_Native_None)
          {
            ite =
              (
                (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                  .tag = FStar_Pervasives_Native_None
                }
              );
          }
          else if (x2.tag == FStar_Pervasives_Native_Some)
          {
            LowParseWriters_Parsers_rlptr tl = x2.v.snd;
            LowParseWriters_rptr hd = x2.v.fst;
            ite =
              (
                (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                  .tag = FStar_Pervasives_Native_Some,
                  .v = { .fst = hd, .snd = tl }
                }
              );
          }
          else
          {
            ite =
              KRML_EABORT(option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          scrut4 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = { .case_Correct = ite }
              }
            );
        }
        else if (scrut3.tag == Error)
        {
          Prims_string e = scrut3.val.case_Error;
          scrut4 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Error,
                .val = { .case_Error = e }
              }
            );
        }
        else
        {
          scrut4 =
            KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut5;
        if (scrut4.tag == Correct)
        {
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          x2 = scrut4.val.case_Correct;
          scrut5 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = { .case_Correct = x2 }
              }
            );
        }
        else if (scrut4.tag == Error)
        {
          Prims_string e = scrut4.val.case_Error;
          scrut5 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Error,
                .val = { .case_Error = e }
              }
            );
        }
        else
        {
          scrut5 =
            KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut6;
        if (scrut5.tag == Correct)
        {
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          res = scrut5.val.case_Correct;
          scrut6 =
            (
              (iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = { .res = res, .new_pos = pos1 } }
              }
            );
        }
        else if (scrut5.tag == Error)
        {
          Prims_string e = scrut5.val.case_Error;
          scrut6 =
            (
              (iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else
        {
          scrut6 =
            KRML_EABORT(iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__K___LowParseWriters_Parsers_rlptr_bool scrut7;
        if (scrut6.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut6.val.case_IError;
          scrut7 =
            (
              (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut6.tag == LowParseWriters_IOverflow)
        {
          scrut7 =
            ((iresult__K___LowParseWriters_Parsers_rlptr_bool){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut6.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf1 = scrut6.val.case_ICorrect.new_pos;
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          x2 = scrut6.val.case_ICorrect.res;
          if (x2.tag == FStar_Pervasives_Native_None)
          {
            result__K___LowParseWriters_Parsers_rlptr_bool
            scrut8 = { .tag = Correct, .val = { .case_Correct = { .fst = x1, .snd = false } } };
            result__K___LowParseWriters_Parsers_rlptr_bool scrut;
            if (scrut8.tag == Correct)
            {
              __LowParseWriters_Parsers_rlptr_bool x3 = scrut8.val.case_Correct;
              scrut =
                (
                  (result__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = Correct,
                    .val = { .case_Correct = x3 }
                  }
                );
            }
            else if (scrut8.tag == Error)
            {
              Prims_string e = scrut8.val.case_Error;
              scrut =
                (
                  (result__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = Error,
                    .val = { .case_Error = e }
                  }
                );
            }
            else
            {
              scrut =
                KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut.tag == Correct)
            {
              __LowParseWriters_Parsers_rlptr_bool res = scrut.val.case_Correct;
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
                  }
                );
            }
            else if (scrut.tag == Error)
            {
              Prims_string e = scrut.val.case_Error;
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else
            {
              scrut7 =
                KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else if (x2.tag == FStar_Pervasives_Native_Some)
          {
            LowParseWriters_Parsers_rlptr tl = x2.v.snd;
            LowParseWriters_rptr hd = x2.v.fst;
            uint8_t *buf_ = buf + posf1;
            LowParse_Slice_slice sl1 = { .base = hd.rptr_base, .len = hd.rptr_len };
            uint32_t pos2 = Parsers_ResumeInfo13_accessor_resumeInfo13_ticket(sl1, (uint32_t)0U);
            uint32_t pos_ = Parsers_TicketContents13_ticketContents13_jumper(sl1, pos2);
            uint8_t *b1 = hd.rptr_base + pos2;
            uint32_t len_ = pos_ - pos2;
            uint8_t *b_ = b1;
            uint8_t *base_ = b_;
            uint32_t len_0 = len_;
            result__LowParseWriters_rptr
            scrut8 =
              {
                .tag = Correct,
                .val = { .case_Correct = { .rptr_base = base_, .rptr_len = len_0 } }
              };
            result__LowParseWriters_rptr scrut9;
            if (scrut8.tag == Correct)
            {
              LowParseWriters_rptr x3 = scrut8.val.case_Correct;
              scrut9 =
                ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x3 } });
            }
            else if (scrut8.tag == Error)
            {
              Prims_string e = scrut8.val.case_Error;
              scrut9 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
            }
            else
            {
              scrut9 =
                KRML_EABORT(result__LowParseWriters_rptr,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            result__LowParseWriters_rptr scrut10;
            if (scrut9.tag == Correct)
            {
              LowParseWriters_rptr x3 = scrut9.val.case_Correct;
              scrut10 =
                ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x3 } });
            }
            else if (scrut9.tag == Error)
            {
              Prims_string e = scrut9.val.case_Error;
              scrut10 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
            }
            else
            {
              scrut10 =
                KRML_EABORT(result__LowParseWriters_rptr,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            iresult__LowParseWriters_rptr scrut11;
            if (scrut10.tag == Correct)
            {
              LowParseWriters_rptr res = scrut10.val.case_Correct;
              scrut11 =
                (
                  (iresult__LowParseWriters_rptr){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = { .res = res, .new_pos = (uint32_t)0U } }
                  }
                );
            }
            else if (scrut10.tag == Error)
            {
              Prims_string e = scrut10.val.case_Error;
              scrut11 =
                (
                  (iresult__LowParseWriters_rptr){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else
            {
              scrut11 =
                KRML_EABORT(iresult__LowParseWriters_rptr,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            LowParseWriters_iresult____ scrut12;
            if (scrut11.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut11.val.case_IError;
              scrut12 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut11.tag == LowParseWriters_IOverflow)
            {
              scrut12 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut11.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf2 = scrut11.val.case_ICorrect.new_pos;
              LowParseWriters_rptr x3 = scrut11.val.case_ICorrect.res;
              scrut12 =
                Negotiation_Writers_NoHoare_extract_compute_binder(x3,
                  buf_,
                  len - posf1,
                  posf2);
            }
            else
            {
              scrut12 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            LowParseWriters_iresult____ scrut13;
            if (scrut12.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut12.val.case_IError;
              scrut13 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut12.tag == LowParseWriters_IOverflow)
            {
              scrut13 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut12.tag == LowParseWriters_ICorrect)
            {
              uint32_t wlen = scrut12.val.case_ICorrect;
              scrut13 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = posf1 + wlen }
                  }
                );
            }
            else
            {
              scrut13 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut13.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut13.val.case_IError;
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut13.tag == LowParseWriters_IOverflow)
            {
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_IOverflow
                  }
                );
            }
            else if (scrut13.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf2 = scrut13.val.case_ICorrect;
              LowParse_Slice_slice sl = { .base = buf, .len = len };
              uint8_t *x00 = sl.base;
              uint16_t r = load16_be(x00);
              uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
              uint32_t pos_pl0 = (uint32_t)2U;
              uint32_t sz = posf2 - pos_pl0;
              LowParseWriters_iresult____ scrut14;
              if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
              {
                uint16_t v_ = (uint16_t)(posf2 - (uint32_t)2U);
                uint8_t *x0 = sl.base;
                store16_be(x0, v_);
                uint32_t len10 = (uint32_t)2U;
                uint32_t uu____1 = (uint32_t)0U + len10;
                scrut14 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = posf2 }
                    }
                  );
              }
              else
              {
                scrut14 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                    }
                  );
              }
              if (scrut14.tag == LowParseWriters_IError)
              {
                Prims_string e = scrut14.val.case_IError;
                scrut7 =
                  (
                    (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = e }
                    }
                  );
              }
              else if (scrut14.tag == LowParseWriters_IOverflow)
              {
                scrut7 =
                  (
                    (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = LowParseWriters_IOverflow
                    }
                  );
              }
              else if (scrut14.tag == LowParseWriters_ICorrect)
              {
                uint32_t posf3 = scrut14.val.case_ICorrect;
                result__K___LowParseWriters_Parsers_rlptr_bool
                scrut15 = { .tag = Correct, .val = { .case_Correct = { .fst = tl, .snd = true } } };
                result__K___LowParseWriters_Parsers_rlptr_bool scrut;
                if (scrut15.tag == Correct)
                {
                  __LowParseWriters_Parsers_rlptr_bool x5 = scrut15.val.case_Correct;
                  scrut =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Correct,
                        .val = { .case_Correct = x5 }
                      }
                    );
                }
                else if (scrut15.tag == Error)
                {
                  Prims_string e = scrut15.val.case_Error;
                  scrut =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Error,
                        .val = { .case_Error = e }
                      }
                    );
                }
                else
                {
                  scrut =
                    KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut.tag == Correct)
                {
                  __LowParseWriters_Parsers_rlptr_bool res = scrut.val.case_Correct;
                  scrut7 =
                    (
                      (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = LowParseWriters_ICorrect,
                        .val = { .case_ICorrect = { .res = res, .new_pos = posf3 } }
                      }
                    );
                }
                else if (scrut.tag == Error)
                {
                  Prims_string e = scrut.val.case_Error;
                  scrut7 =
                    (
                      (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else
                {
                  scrut7 =
                    KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
              }
              else
              {
                scrut7 =
                  KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
            }
            else
            {
              scrut7 =
                KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else
          {
            scrut7 =
              KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut7 =
            KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__K___LowParseWriters_Parsers_rlptr_bool scrut;
        if (scrut7.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut7.val.case_IError;
          scrut =
            (
              (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut7.tag == LowParseWriters_IOverflow)
        {
          scrut =
            ((iresult__K___LowParseWriters_Parsers_rlptr_bool){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut7.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf1 = scrut7.val.case_ICorrect.new_pos;
          __LowParseWriters_Parsers_rlptr_bool x2 = scrut7.val.case_ICorrect.res;
          LowParseWriters_Parsers_rlptr x_ = x2.fst;
          bool cond = x2.snd;
          result__K___LowParseWriters_Parsers_rlptr_bool
          scrut8 = { .tag = Correct, .val = { .case_Correct = { .fst = x_, .snd = cond } } };
          if (scrut8.tag == Correct)
          {
            __LowParseWriters_Parsers_rlptr_bool res = scrut8.val.case_Correct;
            scrut =
              (
                (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
                }
              );
          }
          else if (scrut8.tag == Error)
          {
            Prims_string e = scrut8.val.case_Error;
            scrut =
              (
                (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else
          {
            scrut =
              KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut =
            KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut.tag == LowParseWriters_ICorrect)
        {
          uint32_t pos_ = scrut.val.case_ICorrect.new_pos;
          bool cont = scrut.val.case_ICorrect.res.snd;
          LowParseWriters_Parsers_rlptr x_ = scrut.val.case_ICorrect.res.fst;
          btemp =
            (
              (iresult__LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = { .res = x_, .new_pos = pos_ } }
              }
            );
          ite0 = !cont;
        }
        else if (scrut.tag == LowParseWriters_IError)
        {
          Prims_string s = scrut.val.case_IError;
          btemp =
            (
              (iresult__LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = s }
              }
            );
          ite0 = true;
        }
        else if (scrut.tag == LowParseWriters_IOverflow)
        {
          btemp = ((iresult__LowParseWriters_Parsers_rlptr){ .tag = LowParseWriters_IOverflow });
          ite0 = true;
        }
        else
        {
          ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
        }
      }
      else
      {
        ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (ite0)
      {
        break;
      }
    }
    iresult__LowParseWriters_Parsers_rlptr scrut2 = btemp;
    LowParseWriters_iresult____ scrut3;
    if (scrut2.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut2.val.case_IError;
      scrut3 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut2.tag == LowParseWriters_IOverflow)
    {
      scrut3 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut2.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut2.val.case_ICorrect.new_pos;
      result____ scrut4 = { .tag = Correct };
      result____ scrut;
      if (scrut4.tag == Correct)
      {
        scrut = ((result____){ .tag = Correct });
      }
      else if (scrut4.tag == Error)
      {
        Prims_string e = scrut4._0;
        scrut = ((result____){ .tag = Error, ._0 = e });
      }
      else
      {
        scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut.tag == Correct)
      {
        scrut3 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else if (scrut.tag == Error)
      {
        Prims_string e = scrut._0;
        scrut3 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut3 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut3 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut3.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut3.val.case_IError;
      scrut1 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut3.tag == LowParseWriters_IOverflow)
    {
      scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut3.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut3.val.case_ICorrect;
      uint32_t sz = posf1 - (uint32_t)2U;
      if ((uint32_t)33U <= sz && sz <= (uint32_t)65535U)
      {
        scrut1 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else
      {
        scrut1 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = "parse_vllist_recast: out of bounds" }
            }
          );
      }
    }
    else
    {
      scrut1 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
  }
  else
  {
    scrut1 =
      KRML_EABORT(LowParseWriters_iresult____,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut1.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut1.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut1.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut1.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut1.val.case_ICorrect;
    result____ scrut2 = { .tag = Correct };
    result____ scrut;
    if (scrut2.tag == Correct)
    {
      scrut = ((result____){ .tag = Correct });
    }
    else if (scrut2.tag == Error)
    {
      Prims_string e = scrut2._0;
      scrut = ((result____){ .tag = Error, ._0 = e });
    }
    else
    {
      scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut.tag == Correct)
    {
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = posf }
          }
        );
    }
    else if (scrut.tag == Error)
    {
      Prims_string e = scrut._0;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_pskidentities(
  LowParseWriters_Parsers_rlptr lri,
  uint32_t now,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint32_t pos_pl = (uint32_t)2U;
  LowParseWriters_iresult____ scrut0;
  if (len < pos_pl)
  {
    scrut0 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else
  {
    LowParse_Slice_slice sl = { .base = buf, .len = len };
    uint16_t v_ = (uint16_t)(pos_pl - (uint32_t)2U);
    uint8_t *x0 = sl.base;
    store16_be(x0, v_);
    uint32_t len1 = (uint32_t)2U;
    uint32_t uu____0 = (uint32_t)0U + len1;
    scrut0 =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos_pl }
        }
      );
  }
  LowParseWriters_iresult____ scrut1;
  if (scrut0.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut0.val.case_IError;
    scrut1 =
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut0.tag == LowParseWriters_IOverflow)
  {
    scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut0.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut0.val.case_ICorrect;
    iresult__LowParseWriters_Parsers_rlptr
    btemp =
      {
        .tag = LowParseWriters_ICorrect,
        .val = { .case_ICorrect = { .res = lri, .new_pos = posf } }
      };
    while (true)
    {
      iresult__LowParseWriters_Parsers_rlptr scrut2 = btemp;
      bool ite0;
      if (scrut2.tag == LowParseWriters_ICorrect)
      {
        uint32_t pos1 = scrut2.val.case_ICorrect.new_pos;
        LowParseWriters_Parsers_rlptr x1 = scrut2.val.case_ICorrect.res;
        uint8_t *base = x1.rlptr_base;
        uint32_t len1 = x1.rlptr_len;
        LowParse_Slice_slice sl0 = { .base = base, .len = len1 };
        result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut3;
        if (x1.rlptr_len == (uint32_t)0U)
        {
          scrut3 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
              }
            );
        }
        else
        {
          uint32_t pos2 = Parsers_ResumeInfo13_resumeInfo13_jumper(sl0, (uint32_t)0U);
          uint8_t *b_hd = base;
          uint32_t len_tl = len1 - pos2;
          uint8_t *b_tl = base + pos2;
          scrut3 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = {
                  .case_Correct = {
                    .tag = FStar_Pervasives_Native_Some,
                    .v = {
                      .fst = { .rptr_base = b_hd, .rptr_len = pos2 },
                      .snd = { .rlptr_base = b_tl, .rlptr_len = len_tl }
                    }
                  }
                }
              }
            );
        }
        result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut4;
        if (scrut3.tag == Correct)
        {
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          x2 = scrut3.val.case_Correct;
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr ite;
          if (x2.tag == FStar_Pervasives_Native_None)
          {
            ite =
              (
                (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                  .tag = FStar_Pervasives_Native_None
                }
              );
          }
          else if (x2.tag == FStar_Pervasives_Native_Some)
          {
            LowParseWriters_Parsers_rlptr tl = x2.v.snd;
            LowParseWriters_rptr hd = x2.v.fst;
            ite =
              (
                (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                  .tag = FStar_Pervasives_Native_Some,
                  .v = { .fst = hd, .snd = tl }
                }
              );
          }
          else
          {
            ite =
              KRML_EABORT(option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          scrut4 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = { .case_Correct = ite }
              }
            );
        }
        else if (scrut3.tag == Error)
        {
          Prims_string e = scrut3.val.case_Error;
          scrut4 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Error,
                .val = { .case_Error = e }
              }
            );
        }
        else
        {
          scrut4 =
            KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut5;
        if (scrut4.tag == Correct)
        {
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          x2 = scrut4.val.case_Correct;
          scrut5 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Correct,
                .val = { .case_Correct = x2 }
              }
            );
        }
        else if (scrut4.tag == Error)
        {
          Prims_string e = scrut4.val.case_Error;
          scrut5 =
            (
              (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = Error,
                .val = { .case_Error = e }
              }
            );
        }
        else
        {
          scrut5 =
            KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
        scrut6;
        if (scrut5.tag == Correct)
        {
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          res = scrut5.val.case_Correct;
          scrut6 =
            (
              (iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = { .res = res, .new_pos = pos1 } }
              }
            );
        }
        else if (scrut5.tag == Error)
        {
          Prims_string e = scrut5.val.case_Error;
          scrut6 =
            (
              (iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else
        {
          scrut6 =
            KRML_EABORT(iresult__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__K___LowParseWriters_Parsers_rlptr_bool scrut7;
        if (scrut6.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut6.val.case_IError;
          scrut7 =
            (
              (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut6.tag == LowParseWriters_IOverflow)
        {
          scrut7 =
            ((iresult__K___LowParseWriters_Parsers_rlptr_bool){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut6.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf1 = scrut6.val.case_ICorrect.new_pos;
          option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
          x2 = scrut6.val.case_ICorrect.res;
          if (x2.tag == FStar_Pervasives_Native_None)
          {
            result__K___LowParseWriters_Parsers_rlptr_bool
            scrut8 = { .tag = Correct, .val = { .case_Correct = { .fst = x1, .snd = false } } };
            result__K___LowParseWriters_Parsers_rlptr_bool scrut;
            if (scrut8.tag == Correct)
            {
              __LowParseWriters_Parsers_rlptr_bool x3 = scrut8.val.case_Correct;
              scrut =
                (
                  (result__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = Correct,
                    .val = { .case_Correct = x3 }
                  }
                );
            }
            else if (scrut8.tag == Error)
            {
              Prims_string e = scrut8.val.case_Error;
              scrut =
                (
                  (result__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = Error,
                    .val = { .case_Error = e }
                  }
                );
            }
            else
            {
              scrut =
                KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut.tag == Correct)
            {
              __LowParseWriters_Parsers_rlptr_bool res = scrut.val.case_Correct;
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
                  }
                );
            }
            else if (scrut.tag == Error)
            {
              Prims_string e = scrut.val.case_Error;
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else
            {
              scrut7 =
                KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else if (x2.tag == FStar_Pervasives_Native_Some)
          {
            LowParseWriters_Parsers_rlptr tl = x2.v.snd;
            LowParseWriters_rptr hd = x2.v.fst;
            uint8_t *buf_ = buf + posf1;
            LowParseWriters_iresult____
            scrut8 =
              Negotiation_Writers_NoHoare_extract_obfuscate_age(now,
                hd,
                buf_,
                len - posf1,
                (uint32_t)0U);
            LowParseWriters_iresult____ scrut9;
            if (scrut8.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut8.val.case_IError;
              scrut9 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut8.tag == LowParseWriters_IOverflow)
            {
              scrut9 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut8.tag == LowParseWriters_ICorrect)
            {
              uint32_t wlen = scrut8.val.case_ICorrect;
              scrut9 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = posf1 + wlen }
                  }
                );
            }
            else
            {
              scrut9 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut9.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut9.val.case_IError;
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut9.tag == LowParseWriters_IOverflow)
            {
              scrut7 =
                (
                  (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                    .tag = LowParseWriters_IOverflow
                  }
                );
            }
            else if (scrut9.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf2 = scrut9.val.case_ICorrect;
              LowParse_Slice_slice sl = { .base = buf, .len = len };
              uint8_t *x00 = sl.base;
              uint16_t r = load16_be(x00);
              uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
              uint32_t pos_pl0 = (uint32_t)2U;
              uint32_t sz = posf2 - pos_pl0;
              LowParseWriters_iresult____ scrut10;
              if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
              {
                uint16_t v_ = (uint16_t)(posf2 - (uint32_t)2U);
                uint8_t *x0 = sl.base;
                store16_be(x0, v_);
                uint32_t len10 = (uint32_t)2U;
                uint32_t uu____1 = (uint32_t)0U + len10;
                scrut10 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_ICorrect,
                      .val = { .case_ICorrect = posf2 }
                    }
                  );
              }
              else
              {
                scrut10 =
                  (
                    (LowParseWriters_iresult____){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                    }
                  );
              }
              if (scrut10.tag == LowParseWriters_IError)
              {
                Prims_string e = scrut10.val.case_IError;
                scrut7 =
                  (
                    (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = LowParseWriters_IError,
                      .val = { .case_IError = e }
                    }
                  );
              }
              else if (scrut10.tag == LowParseWriters_IOverflow)
              {
                scrut7 =
                  (
                    (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = LowParseWriters_IOverflow
                    }
                  );
              }
              else if (scrut10.tag == LowParseWriters_ICorrect)
              {
                uint32_t posf3 = scrut10.val.case_ICorrect;
                result__K___LowParseWriters_Parsers_rlptr_bool
                scrut11 = { .tag = Correct, .val = { .case_Correct = { .fst = tl, .snd = true } } };
                result__K___LowParseWriters_Parsers_rlptr_bool scrut;
                if (scrut11.tag == Correct)
                {
                  __LowParseWriters_Parsers_rlptr_bool x5 = scrut11.val.case_Correct;
                  scrut =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Correct,
                        .val = { .case_Correct = x5 }
                      }
                    );
                }
                else if (scrut11.tag == Error)
                {
                  Prims_string e = scrut11.val.case_Error;
                  scrut =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Error,
                        .val = { .case_Error = e }
                      }
                    );
                }
                else
                {
                  scrut =
                    KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut.tag == Correct)
                {
                  __LowParseWriters_Parsers_rlptr_bool res = scrut.val.case_Correct;
                  scrut7 =
                    (
                      (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = LowParseWriters_ICorrect,
                        .val = { .case_ICorrect = { .res = res, .new_pos = posf3 } }
                      }
                    );
                }
                else if (scrut.tag == Error)
                {
                  Prims_string e = scrut.val.case_Error;
                  scrut7 =
                    (
                      (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else
                {
                  scrut7 =
                    KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
              }
              else
              {
                scrut7 =
                  KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
            }
            else
            {
              scrut7 =
                KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else
          {
            scrut7 =
              KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut7 =
            KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        iresult__K___LowParseWriters_Parsers_rlptr_bool scrut;
        if (scrut7.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut7.val.case_IError;
          scrut =
            (
              (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut7.tag == LowParseWriters_IOverflow)
        {
          scrut =
            ((iresult__K___LowParseWriters_Parsers_rlptr_bool){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut7.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf1 = scrut7.val.case_ICorrect.new_pos;
          __LowParseWriters_Parsers_rlptr_bool x2 = scrut7.val.case_ICorrect.res;
          LowParseWriters_Parsers_rlptr x_ = x2.fst;
          bool cond = x2.snd;
          result__K___LowParseWriters_Parsers_rlptr_bool
          scrut8 = { .tag = Correct, .val = { .case_Correct = { .fst = x_, .snd = cond } } };
          if (scrut8.tag == Correct)
          {
            __LowParseWriters_Parsers_rlptr_bool res = scrut8.val.case_Correct;
            scrut =
              (
                (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
                }
              );
          }
          else if (scrut8.tag == Error)
          {
            Prims_string e = scrut8.val.case_Error;
            scrut =
              (
                (iresult__K___LowParseWriters_Parsers_rlptr_bool){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else
          {
            scrut =
              KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut =
            KRML_EABORT(iresult__K___LowParseWriters_Parsers_rlptr_bool,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut.tag == LowParseWriters_ICorrect)
        {
          uint32_t pos_ = scrut.val.case_ICorrect.new_pos;
          bool cont = scrut.val.case_ICorrect.res.snd;
          LowParseWriters_Parsers_rlptr x_ = scrut.val.case_ICorrect.res.fst;
          btemp =
            (
              (iresult__LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = { .res = x_, .new_pos = pos_ } }
              }
            );
          ite0 = !cont;
        }
        else if (scrut.tag == LowParseWriters_IError)
        {
          Prims_string s = scrut.val.case_IError;
          btemp =
            (
              (iresult__LowParseWriters_Parsers_rlptr){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = s }
              }
            );
          ite0 = true;
        }
        else if (scrut.tag == LowParseWriters_IOverflow)
        {
          btemp = ((iresult__LowParseWriters_Parsers_rlptr){ .tag = LowParseWriters_IOverflow });
          ite0 = true;
        }
        else
        {
          ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
        }
      }
      else
      {
        ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (ite0)
      {
        break;
      }
    }
    iresult__LowParseWriters_Parsers_rlptr scrut2 = btemp;
    LowParseWriters_iresult____ scrut3;
    if (scrut2.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut2.val.case_IError;
      scrut3 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut2.tag == LowParseWriters_IOverflow)
    {
      scrut3 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut2.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut2.val.case_ICorrect.new_pos;
      result____ scrut4 = { .tag = Correct };
      result____ scrut;
      if (scrut4.tag == Correct)
      {
        scrut = ((result____){ .tag = Correct });
      }
      else if (scrut4.tag == Error)
      {
        Prims_string e = scrut4._0;
        scrut = ((result____){ .tag = Error, ._0 = e });
      }
      else
      {
        scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut.tag == Correct)
      {
        scrut3 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else if (scrut.tag == Error)
      {
        Prims_string e = scrut._0;
        scrut3 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut3 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut3 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut3.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut3.val.case_IError;
      scrut1 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut3.tag == LowParseWriters_IOverflow)
    {
      scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut3.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut3.val.case_ICorrect;
      uint32_t sz = posf1 - (uint32_t)2U;
      if ((uint32_t)7U <= sz && sz <= (uint32_t)65535U)
      {
        scrut1 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else
      {
        scrut1 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = "parse_vllist_recast: out of bounds" }
            }
          );
      }
    }
    else
    {
      scrut1 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
  }
  else
  {
    scrut1 =
      KRML_EABORT(LowParseWriters_iresult____,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut1.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut1.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut1.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut1.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut1.val.case_ICorrect;
    result____ scrut2 = { .tag = Correct };
    result____ scrut;
    if (scrut2.tag == Correct)
    {
      scrut = ((result____){ .tag = Correct });
    }
    else if (scrut2.tag == Error)
    {
      Prims_string e = scrut2._0;
      scrut = ((result____){ .tag = Error, ._0 = e });
    }
    else
    {
      scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut.tag == Correct)
    {
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = posf }
          }
        );
    }
    else if (scrut.tag == Error)
    {
      Prims_string e = scrut._0;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_pre_shared_key(
  LowParseWriters_Parsers_rlptr lri,
  uint32_t now,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint8_t *b_ = buf + pos;
  FStar_Pervasives_Native_option__uint32_t scrut0;
  if (len - pos < (uint32_t)2U)
  {
    scrut0 = ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
  }
  else
  {
    scrut0 =
      (
        (FStar_Pervasives_Native_option__uint32_t){
          .tag = FStar_Pervasives_Native_Some,
          .v = Parsers_ExtensionType_extensionType_writer((
              (Parsers_ExtensionType_extensionType){ .tag = Parsers_ExtensionType_Pre_shared_key }
            ),
            ((LowParse_Slice_slice){ .base = b_, .len = len - pos }),
            (uint32_t)0U)
        }
      );
  }
  LowParseWriters_iresult____ scrut1;
  if (scrut0.tag == FStar_Pervasives_Native_None)
  {
    scrut1 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut0.tag == FStar_Pervasives_Native_Some)
  {
    uint32_t xlen = scrut0.v;
    scrut1 =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos + xlen }
        }
      );
  }
  else
  {
    scrut1 =
      KRML_EABORT(LowParseWriters_iresult____,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut1.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut1.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut1.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut1.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut1.val.case_ICorrect;
    uint8_t *buf_ = buf + posf;
    uint32_t ite0;
    if ((uint32_t)65535U < (uint32_t)256U)
    {
      ite0 = (uint32_t)1U;
    }
    else if ((uint32_t)65535U < (uint32_t)65536U)
    {
      ite0 = (uint32_t)2U;
    }
    else if ((uint32_t)65535U < (uint32_t)16777216U)
    {
      ite0 = (uint32_t)3U;
    }
    else
    {
      ite0 = (uint32_t)4U;
    }
    result__uint32_t scrut2 = { .tag = Correct, .val = { .case_Correct = ite0 } };
    iresult__uint32_t scrut3;
    if (scrut2.tag == Correct)
    {
      uint32_t res = scrut2.val.case_Correct;
      scrut3 =
        (
          (iresult__uint32_t){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = (uint32_t)0U } }
          }
        );
    }
    else if (scrut2.tag == Error)
    {
      Prims_string e = scrut2.val.case_Error;
      scrut3 = ((iresult__uint32_t){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
    }
    else
    {
      scrut3 = KRML_EABORT(iresult__uint32_t, "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut4;
    if (scrut3.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut3.val.case_IError;
      scrut4 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut3.tag == LowParseWriters_IOverflow)
    {
      scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut3.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut3.val.case_ICorrect.new_pos;
      uint32_t x1 = scrut3.val.case_ICorrect.res;
      uint8_t *b_0 = buf_ + posf1;
      FStar_Pervasives_Native_option__uint32_t (*ite1)(uint8_t *x0, uint32_t x1, uint32_t x2);
      if (Prims_op_GreaterThan(FStar_UInt32_v(x1), (krml_checked_int_t)4294967295))
      {
        ite1 = (void *)0U;
      }
      else
      {
        ite1 = (void *)0U;
      }
      FStar_Pervasives_Native_option__uint32_t scrut5 = ite1(b_0, len - posf - posf1, (uint32_t)0U);
      LowParseWriters_iresult____ scrut6;
      if (scrut5.tag == FStar_Pervasives_Native_None)
      {
        scrut6 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut5.tag == FStar_Pervasives_Native_Some)
      {
        uint32_t xlen = scrut5.v;
        scrut6 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 + xlen }
            }
          );
      }
      else
      {
        scrut6 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut6.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut6.val.case_IError;
        scrut4 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut6.tag == LowParseWriters_IOverflow)
      {
        scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut6.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut6.val.case_ICorrect;
        uint8_t *buf_1 = buf_ + posf2;
        LowParseWriters_iresult____
        scrut7 =
          Negotiation_Writers_NoHoare_extract_write_pskidentities(lri,
            now,
            buf_1,
            len - posf - posf2,
            (uint32_t)0U);
        LowParseWriters_iresult____ scrut8;
        if (scrut7.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut7.val.case_IError;
          scrut8 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut7.tag == LowParseWriters_IOverflow)
        {
          scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut7.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut7.val.case_ICorrect;
          uint8_t *buf_2 = buf_1 + posf3;
          LowParseWriters_iresult____
          scrut9 =
            Negotiation_Writers_NoHoare_extract_write_binders(lri,
              buf_2,
              len - posf - posf2 - posf3,
              (uint32_t)0U);
          LowParseWriters_iresult____ scrut;
          if (scrut9.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut9.val.case_IError;
            scrut =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut9.tag == LowParseWriters_IOverflow)
          {
            scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut9.tag == LowParseWriters_ICorrect)
          {
            uint32_t wlen = scrut9.val.case_ICorrect;
            uint32_t pos_ = posf3 + wlen;
            scrut =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = pos_ }
                }
              );
          }
          else
          {
            scrut =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut.val.case_IError;
            scrut8 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut.tag == LowParseWriters_IOverflow)
          {
            scrut8 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf4 = scrut.val.case_ICorrect;
            scrut8 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf4 }
                }
              );
          }
          else
          {
            scrut8 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
        }
        else
        {
          scrut8 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        LowParseWriters_iresult____ scrut;
        if (scrut8.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut8.val.case_IError;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut8.tag == LowParseWriters_IOverflow)
        {
          scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut8.tag == LowParseWriters_ICorrect)
        {
          uint32_t wlen = scrut8.val.case_ICorrect;
          uint32_t pos_ = posf2 + wlen;
          scrut =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_ICorrect,
                .val = { .case_ICorrect = pos_ }
              }
            );
        }
        else
        {
          scrut =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
        if (scrut.tag == LowParseWriters_IError)
        {
          Prims_string e = scrut.val.case_IError;
          scrut4 =
            (
              (LowParseWriters_iresult____){
                .tag = LowParseWriters_IError,
                .val = { .case_IError = e }
              }
            );
        }
        else if (scrut.tag == LowParseWriters_IOverflow)
        {
          scrut4 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
        }
        else if (scrut.tag == LowParseWriters_ICorrect)
        {
          uint32_t posf3 = scrut.val.case_ICorrect;
          LowParse_Slice_slice sl = { .base = buf_, .len = len - posf };
          uint32_t size = posf3 - (uint32_t)2U;
          if ((uint32_t)0U <= size && size <= (uint32_t)65535U)
          {
            uint16_t v_ = (uint16_t)size;
            uint8_t *x0 = sl.base;
            store16_be(x0, v_);
            uint32_t len1 = (uint32_t)2U;
            uint32_t uu____0 = (uint32_t)0U + len1;
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf3 }
                }
              );
          }
          else
          {
            scrut4 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = "parse_vldata_intro_weak: out of bounds" }
                }
              );
          }
        }
        else
        {
          scrut4 =
            KRML_EABORT(LowParseWriters_iresult____,
              "unreachable (pattern matches are exhaustive in F*)");
        }
      }
      else
      {
        scrut4 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut4 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut5;
    if (scrut4.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut4.val.case_IError;
      scrut5 =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut4.tag == LowParseWriters_IOverflow)
    {
      scrut5 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut4.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut4.val.case_ICorrect;
      result____ scrut6 = { .tag = Correct };
      result____ scrut;
      if (scrut6.tag == Correct)
      {
        scrut = ((result____){ .tag = Correct });
      }
      else if (scrut6.tag == Error)
      {
        Prims_string e = scrut6._0;
        scrut = ((result____){ .tag = Error, ._0 = e });
      }
      else
      {
        scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut.tag == Correct)
      {
        scrut5 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = posf1 }
            }
          );
      }
      else if (scrut.tag == Error)
      {
        Prims_string e = scrut._0;
        scrut5 =
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut5 =
          KRML_EABORT(LowParseWriters_iresult____,
            "unreachable (pattern matches are exhaustive in F*)");
      }
    }
    else
    {
      scrut5 =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    LowParseWriters_iresult____ scrut;
    if (scrut5.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut5.val.case_IError;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut5.tag == LowParseWriters_IOverflow)
    {
      scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut5.tag == LowParseWriters_ICorrect)
    {
      uint32_t wlen = scrut5.val.case_ICorrect;
      uint32_t pos_ = posf + wlen;
      scrut =
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = pos_ }
          }
        );
    }
    else
    {
      scrut =
        KRML_EABORT(LowParseWriters_iresult____,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut.val.case_ICorrect;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = posf1 }
          }
        );
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct iresult__Parsers_ProtocolVersion_protocolVersion_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      Parsers_ProtocolVersion_protocolVersion res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__Parsers_ProtocolVersion_protocolVersion;

typedef struct result__Parsers_ProtocolVersion_protocolVersion_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    Parsers_ProtocolVersion_protocolVersion case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__Parsers_ProtocolVersion_protocolVersion;

typedef struct iresult__bool_s
{
  LowParseWriters_iresult_____tags tag;
  union {
    struct 
    {
      bool res;
      uint32_t new_pos;
    }
    case_ICorrect;
    Prims_string case_IError;
  }
  val;
}
iresult__bool;

typedef struct result__bool_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    bool case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__bool;

typedef struct result__LowParseWriters_Parsers_rlptr_s
{
  result__LowParseWriters_rptr_tags tag;
  union {
    LowParseWriters_Parsers_rlptr case_Correct;
    Prims_string case_Error;
  }
  val;
}
result__LowParseWriters_Parsers_rlptr;

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_write_final_extensions(
  LowParseWriters_rptr cfg,
  bool edi,
  LowParseWriters_Parsers_rlptr lri,
  uint32_t now,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  LowParse_Slice_slice sl0 = { .base = cfg.rptr_base, .len = cfg.rptr_len };
  uint32_t pos10 = Parsers_MiTLSConfig_accessor_miTLSConfig_max_version(sl0, (uint32_t)0U);
  uint32_t pos_ = Parsers_KnownProtocolVersion_knownProtocolVersion_jumper(sl0, pos10);
  uint8_t *b10 = cfg.rptr_base + pos10;
  uint32_t len_ = pos_ - pos10;
  uint8_t *b_ = b10;
  uint8_t *base_ = b_;
  uint32_t len_0 = len_;
  result__LowParseWriters_rptr
  scrut0 =
    { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_, .rptr_len = len_0 } } };
  result__LowParseWriters_rptr scrut1;
  if (scrut0.tag == Correct)
  {
    LowParseWriters_rptr x = scrut0.val.case_Correct;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut0.tag == Error)
  {
    Prims_string e = scrut0.val.case_Error;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut1 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  result__LowParseWriters_rptr scrut2;
  if (scrut1.tag == Correct)
  {
    LowParseWriters_rptr x = scrut1.val.case_Correct;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut1.tag == Error)
  {
    Prims_string e = scrut1.val.case_Error;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut2 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  iresult__LowParseWriters_rptr scrut3;
  if (scrut2.tag == Correct)
  {
    LowParseWriters_rptr res = scrut2.val.case_Correct;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = { .res = res, .new_pos = pos } }
        }
      );
  }
  else if (scrut2.tag == Error)
  {
    Prims_string e = scrut2.val.case_Error;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_IError,
          .val = { .case_IError = e }
        }
      );
  }
  else
  {
    scrut3 =
      KRML_EABORT(iresult__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut3.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut3.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut3.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut3.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut3.val.case_ICorrect.new_pos;
    LowParseWriters_rptr x = scrut3.val.case_ICorrect.res;
    LowParse_Slice_slice sl1 = { .base = x.rptr_base, .len = x.rptr_len };
    uint32_t
    pos11 = Parsers_KnownProtocolVersion_knownProtocolVersion_accessor_tag(sl1, (uint32_t)0U);
    uint32_t pos_0 = Parsers_ProtocolVersion_protocolVersion_jumper(sl1, pos11);
    uint8_t *b1 = x.rptr_base + pos11;
    uint32_t len_1 = pos_0 - pos11;
    uint8_t *b_0 = b1;
    uint8_t *base_0 = b_0;
    uint32_t len_2 = len_1;
    result__LowParseWriters_rptr
    scrut4 =
      { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_0, .rptr_len = len_2 } } };
    result__LowParseWriters_rptr scrut5;
    if (scrut4.tag == Correct)
    {
      LowParseWriters_rptr x1 = scrut4.val.case_Correct;
      scrut5 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x1 } });
    }
    else if (scrut4.tag == Error)
    {
      Prims_string e = scrut4.val.case_Error;
      scrut5 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
    }
    else
    {
      scrut5 =
        KRML_EABORT(result__LowParseWriters_rptr,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    result__LowParseWriters_rptr scrut6;
    if (scrut5.tag == Correct)
    {
      LowParseWriters_rptr x1 = scrut5.val.case_Correct;
      scrut6 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x1 } });
    }
    else if (scrut5.tag == Error)
    {
      Prims_string e = scrut5.val.case_Error;
      scrut6 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
    }
    else
    {
      scrut6 =
        KRML_EABORT(result__LowParseWriters_rptr,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    iresult__LowParseWriters_rptr scrut7;
    if (scrut6.tag == Correct)
    {
      LowParseWriters_rptr res = scrut6.val.case_Correct;
      scrut7 =
        (
          (iresult__LowParseWriters_rptr){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = posf } }
          }
        );
    }
    else if (scrut6.tag == Error)
    {
      Prims_string e = scrut6.val.case_Error;
      scrut7 =
        (
          (iresult__LowParseWriters_rptr){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else
    {
      scrut7 =
        KRML_EABORT(iresult__LowParseWriters_rptr,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut7.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut7.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut7.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut7.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut7.val.case_ICorrect.new_pos;
      LowParseWriters_rptr x1 = scrut7.val.case_ICorrect.res;
      result__Parsers_ProtocolVersion_protocolVersion
      scrut8 =
        {
          .tag = Correct,
          .val = {
            .case_Correct = Parsers_ProtocolVersion_protocolVersion_reader((
                (LowParse_Slice_slice){ .base = x1.rptr_base, .len = x1.rptr_len }
              ),
              (uint32_t)0U)
          }
        };
      result__Parsers_ProtocolVersion_protocolVersion scrut9;
      if (scrut8.tag == Correct)
      {
        Parsers_ProtocolVersion_protocolVersion x2 = scrut8.val.case_Correct;
        scrut9 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Correct,
              .val = { .case_Correct = x2 }
            }
          );
      }
      else if (scrut8.tag == Error)
      {
        Prims_string e = scrut8.val.case_Error;
        scrut9 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Error,
              .val = { .case_Error = e }
            }
          );
      }
      else
      {
        scrut9 =
          KRML_EABORT(result__Parsers_ProtocolVersion_protocolVersion,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      result__Parsers_ProtocolVersion_protocolVersion scrut10;
      if (scrut9.tag == Correct)
      {
        Parsers_ProtocolVersion_protocolVersion x2 = scrut9.val.case_Correct;
        scrut10 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Correct,
              .val = { .case_Correct = x2 }
            }
          );
      }
      else if (scrut9.tag == Error)
      {
        Prims_string e = scrut9.val.case_Error;
        scrut10 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Error,
              .val = { .case_Error = e }
            }
          );
      }
      else
      {
        scrut10 =
          KRML_EABORT(result__Parsers_ProtocolVersion_protocolVersion,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      iresult__Parsers_ProtocolVersion_protocolVersion scrut11;
      if (scrut10.tag == Correct)
      {
        Parsers_ProtocolVersion_protocolVersion res = scrut10.val.case_Correct;
        scrut11 =
          (
            (iresult__Parsers_ProtocolVersion_protocolVersion){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
            }
          );
      }
      else if (scrut10.tag == Error)
      {
        Prims_string e = scrut10.val.case_Error;
        scrut11 =
          (
            (iresult__Parsers_ProtocolVersion_protocolVersion){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut11 =
          KRML_EABORT(iresult__Parsers_ProtocolVersion_protocolVersion,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut11.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut11.val.case_IError;
        return
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut11.tag == LowParseWriters_IOverflow)
      {
        return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut11.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut11.val.case_ICorrect.new_pos;
        Parsers_ProtocolVersion_protocolVersion x2 = scrut11.val.case_ICorrect.res;
        if (x2.tag == Parsers_ProtocolVersion_TLS_1p3)
        {
          result__LowParseWriters_Parsers_rlptr
          btemp0 = { .tag = Correct, .val = { .case_Correct = lri } };
          while (true)
          {
            result__LowParseWriters_Parsers_rlptr scrut12 = btemp0;
            bool ite0;
            if (scrut12.tag == Correct)
            {
              LowParseWriters_Parsers_rlptr x3 = scrut12.val.case_Correct;
              uint8_t *base = x3.rlptr_base;
              uint32_t len1 = x3.rlptr_len;
              LowParse_Slice_slice sl = { .base = base, .len = len1 };
              result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
              scrut13;
              if (x3.rlptr_len == (uint32_t)0U)
              {
                scrut13 =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
                    }
                  );
              }
              else
              {
                uint32_t pos1 = Parsers_ResumeInfo13_resumeInfo13_jumper(sl, (uint32_t)0U);
                uint8_t *b_hd = base;
                uint32_t len_tl = len1 - pos1;
                uint8_t *b_tl = base + pos1;
                scrut13 =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = {
                        .case_Correct = {
                          .tag = FStar_Pervasives_Native_Some,
                          .v = {
                            .fst = { .rptr_base = b_hd, .rptr_len = pos1 },
                            .snd = { .rlptr_base = b_tl, .rlptr_len = len_tl }
                          }
                        }
                      }
                    }
                  );
              }
              result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
              scrut14;
              if (scrut13.tag == Correct)
              {
                option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                x4 = scrut13.val.case_Correct;
                option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr ite;
                if (x4.tag == FStar_Pervasives_Native_None)
                {
                  ite =
                    (
                      (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = FStar_Pervasives_Native_None
                      }
                    );
                }
                else if (x4.tag == FStar_Pervasives_Native_Some)
                {
                  LowParseWriters_Parsers_rlptr tl = x4.v.snd;
                  LowParseWriters_rptr hd = x4.v.fst;
                  ite =
                    (
                      (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = FStar_Pervasives_Native_Some,
                        .v = { .fst = hd, .snd = tl }
                      }
                    );
                }
                else
                {
                  ite =
                    KRML_EABORT(option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                scrut14 =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = { .case_Correct = ite }
                    }
                  );
              }
              else if (scrut13.tag == Error)
              {
                Prims_string e = scrut13.val.case_Error;
                scrut14 =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Error,
                      .val = { .case_Error = e }
                    }
                  );
              }
              else
              {
                scrut14 =
                  KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              result__K___LowParseWriters_Parsers_rlptr_bool scrut15;
              if (scrut14.tag == Correct)
              {
                option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                x4 = scrut14.val.case_Correct;
                if (x4.tag == FStar_Pervasives_Native_None)
                {
                  scrut15 =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Correct,
                        .val = { .case_Correct = { .fst = x3, .snd = false } }
                      }
                    );
                }
                else if (x4.tag == FStar_Pervasives_Native_Some)
                {
                  LowParseWriters_Parsers_rlptr tl = x4.v.snd;
                  result__bool scrut = { .tag = Correct, .val = { .case_Correct = true } };
                  if (scrut.tag == Correct)
                  {
                    bool x5 = scrut.val.case_Correct;
                    __LowParseWriters_Parsers_rlptr_bool ite;
                    if (x5)
                    {
                      ite = ((__LowParseWriters_Parsers_rlptr_bool){ .fst = x3, .snd = false });
                    }
                    else
                    {
                      ite = ((__LowParseWriters_Parsers_rlptr_bool){ .fst = tl, .snd = true });
                    }
                    scrut15 =
                      (
                        (result__K___LowParseWriters_Parsers_rlptr_bool){
                          .tag = Correct,
                          .val = { .case_Correct = ite }
                        }
                      );
                  }
                  else if (scrut.tag == Error)
                  {
                    Prims_string e = scrut.val.case_Error;
                    scrut15 =
                      (
                        (result__K___LowParseWriters_Parsers_rlptr_bool){
                          .tag = Error,
                          .val = { .case_Error = e }
                        }
                      );
                  }
                  else
                  {
                    scrut15 =
                      KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                        "unreachable (pattern matches are exhaustive in F*)");
                  }
                }
                else
                {
                  scrut15 =
                    KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
              }
              else if (scrut14.tag == Error)
              {
                Prims_string e = scrut14.val.case_Error;
                scrut15 =
                  (
                    (result__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = Error,
                      .val = { .case_Error = e }
                    }
                  );
              }
              else
              {
                scrut15 =
                  KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              result__K___LowParseWriters_Parsers_rlptr_bool scrut;
              if (scrut15.tag == Correct)
              {
                __LowParseWriters_Parsers_rlptr_bool x4 = scrut15.val.case_Correct;
                LowParseWriters_Parsers_rlptr x_ = x4.fst;
                bool cond = x4.snd;
                scrut =
                  (
                    (result__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = Correct,
                      .val = { .case_Correct = { .fst = x_, .snd = cond } }
                    }
                  );
              }
              else if (scrut15.tag == Error)
              {
                Prims_string e = scrut15.val.case_Error;
                scrut =
                  (
                    (result__K___LowParseWriters_Parsers_rlptr_bool){
                      .tag = Error,
                      .val = { .case_Error = e }
                    }
                  );
              }
              else
              {
                scrut =
                  KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              if (scrut.tag == Correct)
              {
                bool cont = scrut.val.case_Correct.snd;
                LowParseWriters_Parsers_rlptr x_ = scrut.val.case_Correct.fst;
                btemp0 =
                  (
                    (result__LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = { .case_Correct = x_ }
                    }
                  );
                ite0 = !cont;
              }
              else if (scrut.tag == Error)
              {
                Prims_string s = scrut.val.case_Error;
                btemp0 =
                  (
                    (result__LowParseWriters_Parsers_rlptr){
                      .tag = Error,
                      .val = { .case_Error = s }
                    }
                  );
                ite0 = true;
              }
              else
              {
                ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
              }
            }
            else
            {
              ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
            }
            if (ite0)
            {
              break;
            }
          }
          result__LowParseWriters_Parsers_rlptr scrut12 = btemp0;
          result__bool scrut13;
          if (scrut12.tag == Correct)
          {
            LowParseWriters_Parsers_rlptr x3 = scrut12.val.case_Correct;
            uint8_t *base = x3.rlptr_base;
            uint32_t len1 = x3.rlptr_len;
            LowParse_Slice_slice sl = { .base = base, .len = len1 };
            result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
            scrut14;
            if (x3.rlptr_len == (uint32_t)0U)
            {
              scrut14 =
                (
                  (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                    .tag = Correct,
                    .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
                  }
                );
            }
            else
            {
              uint32_t pos1 = Parsers_ResumeInfo13_resumeInfo13_jumper(sl, (uint32_t)0U);
              uint8_t *b_hd = base;
              uint32_t len_tl = len1 - pos1;
              uint8_t *b_tl = base + pos1;
              scrut14 =
                (
                  (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                    .tag = Correct,
                    .val = {
                      .case_Correct = {
                        .tag = FStar_Pervasives_Native_Some,
                        .v = {
                          .fst = { .rptr_base = b_hd, .rptr_len = pos1 },
                          .snd = { .rlptr_base = b_tl, .rlptr_len = len_tl }
                        }
                      }
                    }
                  }
                );
            }
            result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
            scrut;
            if (scrut14.tag == Correct)
            {
              option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
              x4 = scrut14.val.case_Correct;
              option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr ite;
              if (x4.tag == FStar_Pervasives_Native_None)
              {
                ite =
                  (
                    (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = FStar_Pervasives_Native_None
                    }
                  );
              }
              else if (x4.tag == FStar_Pervasives_Native_Some)
              {
                LowParseWriters_Parsers_rlptr tl = x4.v.snd;
                LowParseWriters_rptr hd = x4.v.fst;
                ite =
                  (
                    (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = FStar_Pervasives_Native_Some,
                      .v = { .fst = hd, .snd = tl }
                    }
                  );
              }
              else
              {
                ite =
                  KRML_EABORT(option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              scrut =
                (
                  (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                    .tag = Correct,
                    .val = { .case_Correct = ite }
                  }
                );
            }
            else if (scrut14.tag == Error)
            {
              Prims_string e = scrut14.val.case_Error;
              scrut =
                (
                  (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                    .tag = Error,
                    .val = { .case_Error = e }
                  }
                );
            }
            else
            {
              scrut =
                KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut.tag == Correct)
            {
              option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
              x4 = scrut.val.case_Correct;
              bool ite;
              if (x4.tag == FStar_Pervasives_Native_None)
              {
                ite = false;
              }
              else
              {
                ite = true;
              }
              scrut13 = ((result__bool){ .tag = Correct, .val = { .case_Correct = ite } });
            }
            else if (scrut.tag == Error)
            {
              Prims_string e = scrut.val.case_Error;
              scrut13 = ((result__bool){ .tag = Error, .val = { .case_Error = e } });
            }
            else
            {
              scrut13 =
                KRML_EABORT(result__bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else if (scrut12.tag == Error)
          {
            Prims_string e = scrut12.val.case_Error;
            scrut13 = ((result__bool){ .tag = Error, .val = { .case_Error = e } });
          }
          else
          {
            scrut13 =
              KRML_EABORT(result__bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          result__bool scrut14;
          if (scrut13.tag == Correct)
          {
            bool x3 = scrut13.val.case_Correct;
            scrut14 = ((result__bool){ .tag = Correct, .val = { .case_Correct = x3 } });
          }
          else if (scrut13.tag == Error)
          {
            Prims_string e = scrut13.val.case_Error;
            scrut14 = ((result__bool){ .tag = Error, .val = { .case_Error = e } });
          }
          else
          {
            scrut14 =
              KRML_EABORT(result__bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          iresult__bool scrut15;
          if (scrut14.tag == Correct)
          {
            bool res = scrut14.val.case_Correct;
            scrut15 =
              (
                (iresult__bool){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = { .res = res, .new_pos = posf2 } }
                }
              );
          }
          else if (scrut14.tag == Error)
          {
            Prims_string e = scrut14.val.case_Error;
            scrut15 =
              ((iresult__bool){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
          }
          else
          {
            scrut15 =
              KRML_EABORT(iresult__bool,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut15.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut15.val.case_IError;
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut15.tag == LowParseWriters_IOverflow)
          {
            return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut15.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf3 = scrut15.val.case_ICorrect.new_pos;
            bool x3 = scrut15.val.case_ICorrect.res;
            result__LowParseWriters_Parsers_rlptr
            btemp = { .tag = Correct, .val = { .case_Correct = lri } };
            while (true)
            {
              result__LowParseWriters_Parsers_rlptr scrut16 = btemp;
              bool ite0;
              if (scrut16.tag == Correct)
              {
                LowParseWriters_Parsers_rlptr x4 = scrut16.val.case_Correct;
                uint8_t *base = x4.rlptr_base;
                uint32_t len1 = x4.rlptr_len;
                LowParse_Slice_slice sl = { .base = base, .len = len1 };
                result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                scrut17;
                if (x4.rlptr_len == (uint32_t)0U)
                {
                  scrut17 =
                    (
                      (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = Correct,
                        .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
                      }
                    );
                }
                else
                {
                  uint32_t pos1 = Parsers_ResumeInfo13_resumeInfo13_jumper(sl, (uint32_t)0U);
                  uint8_t *b_hd = base;
                  uint32_t len_tl = len1 - pos1;
                  uint8_t *b_tl = base + pos1;
                  scrut17 =
                    (
                      (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = Correct,
                        .val = {
                          .case_Correct = {
                            .tag = FStar_Pervasives_Native_Some,
                            .v = {
                              .fst = { .rptr_base = b_hd, .rptr_len = pos1 },
                              .snd = { .rlptr_base = b_tl, .rlptr_len = len_tl }
                            }
                          }
                        }
                      }
                    );
                }
                result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                scrut18;
                if (scrut17.tag == Correct)
                {
                  option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                  x5 = scrut17.val.case_Correct;
                  option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr ite;
                  if (x5.tag == FStar_Pervasives_Native_None)
                  {
                    ite =
                      (
                        (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                          .tag = FStar_Pervasives_Native_None
                        }
                      );
                  }
                  else if (x5.tag == FStar_Pervasives_Native_Some)
                  {
                    LowParseWriters_Parsers_rlptr tl = x5.v.snd;
                    LowParseWriters_rptr hd = x5.v.fst;
                    ite =
                      (
                        (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                          .tag = FStar_Pervasives_Native_Some,
                          .v = { .fst = hd, .snd = tl }
                        }
                      );
                  }
                  else
                  {
                    ite =
                      KRML_EABORT(option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                        "unreachable (pattern matches are exhaustive in F*)");
                  }
                  scrut18 =
                    (
                      (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = Correct,
                        .val = { .case_Correct = ite }
                      }
                    );
                }
                else if (scrut17.tag == Error)
                {
                  Prims_string e = scrut17.val.case_Error;
                  scrut18 =
                    (
                      (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = Error,
                        .val = { .case_Error = e }
                      }
                    );
                }
                else
                {
                  scrut18 =
                    KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                result__K___LowParseWriters_Parsers_rlptr_bool scrut19;
                if (scrut18.tag == Correct)
                {
                  option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                  x5 = scrut18.val.case_Correct;
                  if (x5.tag == FStar_Pervasives_Native_None)
                  {
                    scrut19 =
                      (
                        (result__K___LowParseWriters_Parsers_rlptr_bool){
                          .tag = Correct,
                          .val = { .case_Correct = { .fst = x4, .snd = false } }
                        }
                      );
                  }
                  else if (x5.tag == FStar_Pervasives_Native_Some)
                  {
                    LowParseWriters_Parsers_rlptr tl = x5.v.snd;
                    result__bool scrut = { .tag = Correct, .val = { .case_Correct = true } };
                    if (scrut.tag == Correct)
                    {
                      bool x6 = scrut.val.case_Correct;
                      __LowParseWriters_Parsers_rlptr_bool ite;
                      if (x6)
                      {
                        ite = ((__LowParseWriters_Parsers_rlptr_bool){ .fst = x4, .snd = false });
                      }
                      else
                      {
                        ite = ((__LowParseWriters_Parsers_rlptr_bool){ .fst = tl, .snd = true });
                      }
                      scrut19 =
                        (
                          (result__K___LowParseWriters_Parsers_rlptr_bool){
                            .tag = Correct,
                            .val = { .case_Correct = ite }
                          }
                        );
                    }
                    else if (scrut.tag == Error)
                    {
                      Prims_string e = scrut.val.case_Error;
                      scrut19 =
                        (
                          (result__K___LowParseWriters_Parsers_rlptr_bool){
                            .tag = Error,
                            .val = { .case_Error = e }
                          }
                        );
                    }
                    else
                    {
                      scrut19 =
                        KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                  }
                  else
                  {
                    scrut19 =
                      KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                        "unreachable (pattern matches are exhaustive in F*)");
                  }
                }
                else if (scrut18.tag == Error)
                {
                  Prims_string e = scrut18.val.case_Error;
                  scrut19 =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Error,
                        .val = { .case_Error = e }
                      }
                    );
                }
                else
                {
                  scrut19 =
                    KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                result__K___LowParseWriters_Parsers_rlptr_bool scrut;
                if (scrut19.tag == Correct)
                {
                  __LowParseWriters_Parsers_rlptr_bool x5 = scrut19.val.case_Correct;
                  LowParseWriters_Parsers_rlptr x_ = x5.fst;
                  bool cond = x5.snd;
                  scrut =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Correct,
                        .val = { .case_Correct = { .fst = x_, .snd = cond } }
                      }
                    );
                }
                else if (scrut19.tag == Error)
                {
                  Prims_string e = scrut19.val.case_Error;
                  scrut =
                    (
                      (result__K___LowParseWriters_Parsers_rlptr_bool){
                        .tag = Error,
                        .val = { .case_Error = e }
                      }
                    );
                }
                else
                {
                  scrut =
                    KRML_EABORT(result__K___LowParseWriters_Parsers_rlptr_bool,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut.tag == Correct)
                {
                  bool cont = scrut.val.case_Correct.snd;
                  LowParseWriters_Parsers_rlptr x_ = scrut.val.case_Correct.fst;
                  btemp =
                    (
                      (result__LowParseWriters_Parsers_rlptr){
                        .tag = Correct,
                        .val = { .case_Correct = x_ }
                      }
                    );
                  ite0 = !cont;
                }
                else if (scrut.tag == Error)
                {
                  Prims_string s = scrut.val.case_Error;
                  btemp =
                    (
                      (result__LowParseWriters_Parsers_rlptr){
                        .tag = Error,
                        .val = { .case_Error = s }
                      }
                    );
                  ite0 = true;
                }
                else
                {
                  ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
                }
              }
              else
              {
                ite0 = KRML_EABORT(bool, "unreachable (pattern matches are exhaustive in F*)");
              }
              if (ite0)
              {
                break;
              }
            }
            result__LowParseWriters_Parsers_rlptr scrut16 = btemp;
            result__bool scrut17;
            if (scrut16.tag == Correct)
            {
              LowParseWriters_Parsers_rlptr x4 = scrut16.val.case_Correct;
              uint8_t *base = x4.rlptr_base;
              uint32_t len1 = x4.rlptr_len;
              LowParse_Slice_slice sl = { .base = base, .len = len1 };
              result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
              scrut18;
              if (x4.rlptr_len == (uint32_t)0U)
              {
                scrut18 =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
                    }
                  );
              }
              else
              {
                uint32_t pos1 = Parsers_ResumeInfo13_resumeInfo13_jumper(sl, (uint32_t)0U);
                uint8_t *b_hd = base;
                uint32_t len_tl = len1 - pos1;
                uint8_t *b_tl = base + pos1;
                scrut18 =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = {
                        .case_Correct = {
                          .tag = FStar_Pervasives_Native_Some,
                          .v = {
                            .fst = { .rptr_base = b_hd, .rptr_len = pos1 },
                            .snd = { .rlptr_base = b_tl, .rlptr_len = len_tl }
                          }
                        }
                      }
                    }
                  );
              }
              result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
              scrut;
              if (scrut18.tag == Correct)
              {
                option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                x5 = scrut18.val.case_Correct;
                option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr ite;
                if (x5.tag == FStar_Pervasives_Native_None)
                {
                  ite =
                    (
                      (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = FStar_Pervasives_Native_None
                      }
                    );
                }
                else if (x5.tag == FStar_Pervasives_Native_Some)
                {
                  LowParseWriters_Parsers_rlptr tl = x5.v.snd;
                  LowParseWriters_rptr hd = x5.v.fst;
                  ite =
                    (
                      (option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                        .tag = FStar_Pervasives_Native_Some,
                        .v = { .fst = hd, .snd = tl }
                      }
                    );
                }
                else
                {
                  ite =
                    KRML_EABORT(option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                scrut =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Correct,
                      .val = { .case_Correct = ite }
                    }
                  );
              }
              else if (scrut18.tag == Error)
              {
                Prims_string e = scrut18.val.case_Error;
                scrut =
                  (
                    (result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr){
                      .tag = Error,
                      .val = { .case_Error = e }
                    }
                  );
              }
              else
              {
                scrut =
                  KRML_EABORT(result__FStar_Pervasives_Native_option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
              if (scrut.tag == Correct)
              {
                option__K___LowParseWriters_rptr_LowParseWriters_Parsers_rlptr
                x5 = scrut.val.case_Correct;
                bool ite;
                if (x5.tag == FStar_Pervasives_Native_None)
                {
                  ite = false;
                }
                else
                {
                  ite = true;
                }
                scrut17 = ((result__bool){ .tag = Correct, .val = { .case_Correct = ite } });
              }
              else if (scrut.tag == Error)
              {
                Prims_string e = scrut.val.case_Error;
                scrut17 = ((result__bool){ .tag = Error, .val = { .case_Error = e } });
              }
              else
              {
                scrut17 =
                  KRML_EABORT(result__bool,
                    "unreachable (pattern matches are exhaustive in F*)");
              }
            }
            else if (scrut16.tag == Error)
            {
              Prims_string e = scrut16.val.case_Error;
              scrut17 = ((result__bool){ .tag = Error, .val = { .case_Error = e } });
            }
            else
            {
              scrut17 =
                KRML_EABORT(result__bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            result__bool scrut18;
            if (scrut17.tag == Correct)
            {
              bool x4 = scrut17.val.case_Correct;
              scrut18 = ((result__bool){ .tag = Correct, .val = { .case_Correct = x4 } });
            }
            else if (scrut17.tag == Error)
            {
              Prims_string e = scrut17.val.case_Error;
              scrut18 = ((result__bool){ .tag = Error, .val = { .case_Error = e } });
            }
            else
            {
              scrut18 =
                KRML_EABORT(result__bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            iresult__bool scrut19;
            if (scrut18.tag == Correct)
            {
              bool res = scrut18.val.case_Correct;
              scrut19 =
                (
                  (iresult__bool){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = { .res = res, .new_pos = posf3 } }
                  }
                );
            }
            else if (scrut18.tag == Error)
            {
              Prims_string e = scrut18.val.case_Error;
              scrut19 =
                ((iresult__bool){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
            }
            else
            {
              scrut19 =
                KRML_EABORT(iresult__bool,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut19.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut19.val.case_IError;
              return
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut19.tag == LowParseWriters_IOverflow)
            {
              return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut19.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf4 = scrut19.val.case_ICorrect.new_pos;
              bool x4 = scrut19.val.case_ICorrect.res;
              if (x3 || x4)
              {
                uint8_t *buf_ = buf + posf4;
                LowParseWriters_iresult____
                scrut20 =
                  Negotiation_Writers_NoHoare_extract_write_psk_kex(x3,
                    x4,
                    buf_,
                    len - posf4,
                    (uint32_t)0U);
                LowParseWriters_iresult____ scrut21;
                if (scrut20.tag == LowParseWriters_IError)
                {
                  Prims_string e = scrut20.val.case_IError;
                  scrut21 =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else if (scrut20.tag == LowParseWriters_IOverflow)
                {
                  scrut21 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                }
                else if (scrut20.tag == LowParseWriters_ICorrect)
                {
                  uint32_t wlen = scrut20.val.case_ICorrect;
                  scrut21 =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_ICorrect,
                        .val = { .case_ICorrect = posf4 + wlen }
                      }
                    );
                }
                else
                {
                  scrut21 =
                    KRML_EABORT(LowParseWriters_iresult____,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                LowParseWriters_iresult____ scrut22;
                if (scrut21.tag == LowParseWriters_IError)
                {
                  Prims_string e = scrut21.val.case_IError;
                  scrut22 =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else if (scrut21.tag == LowParseWriters_IOverflow)
                {
                  scrut22 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                }
                else if (scrut21.tag == LowParseWriters_ICorrect)
                {
                  uint32_t posf5 = scrut21.val.case_ICorrect;
                  LowParse_Slice_slice sl = { .base = buf, .len = len };
                  uint8_t *x00 = sl.base;
                  uint16_t r = load16_be(x00);
                  uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
                  uint32_t pos_pl = (uint32_t)2U;
                  uint32_t sz = posf5 - pos_pl;
                  if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
                  {
                    uint16_t v_ = (uint16_t)(posf5 - (uint32_t)2U);
                    uint8_t *x0 = sl.base;
                    store16_be(x0, v_);
                    uint32_t len1 = (uint32_t)2U;
                    uint32_t uu____0 = (uint32_t)0U + len1;
                    scrut22 =
                      (
                        (LowParseWriters_iresult____){
                          .tag = LowParseWriters_ICorrect,
                          .val = { .case_ICorrect = posf5 }
                        }
                      );
                  }
                  else
                  {
                    scrut22 =
                      (
                        (LowParseWriters_iresult____){
                          .tag = LowParseWriters_IError,
                          .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                        }
                      );
                  }
                }
                else
                {
                  scrut22 =
                    KRML_EABORT(LowParseWriters_iresult____,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut22.tag == LowParseWriters_IError)
                {
                  Prims_string e = scrut22.val.case_IError;
                  return
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else if (scrut22.tag == LowParseWriters_IOverflow)
                {
                  return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                }
                else if (scrut22.tag == LowParseWriters_ICorrect)
                {
                  uint32_t posf5 = scrut22.val.case_ICorrect;
                  LowParseWriters_iresult____ scrut23;
                  if (edi)
                  {
                    uint8_t *buf_0 = buf + posf5;
                    LowParseWriters_iresult____
                    scrut24 =
                      Negotiation_Writers_NoHoare_extract_write_clientHelloExtension_CHE_early_data(buf_0,
                        len - posf5,
                        (uint32_t)0U);
                    LowParseWriters_iresult____ scrut;
                    if (scrut24.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut24.val.case_IError;
                      scrut =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut24.tag == LowParseWriters_IOverflow)
                    {
                      scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut24.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t wlen = scrut24.val.case_ICorrect;
                      scrut =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_ICorrect,
                            .val = { .case_ICorrect = posf5 + wlen }
                          }
                        );
                    }
                    else
                    {
                      scrut =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                    if (scrut.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut.val.case_IError;
                      scrut23 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut.tag == LowParseWriters_IOverflow)
                    {
                      scrut23 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t posf6 = scrut.val.case_ICorrect;
                      LowParse_Slice_slice sl = { .base = buf, .len = len };
                      uint8_t *x00 = sl.base;
                      uint16_t r = load16_be(x00);
                      uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
                      uint32_t pos_pl = (uint32_t)2U;
                      uint32_t sz = posf6 - pos_pl;
                      if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
                      {
                        uint16_t v_ = (uint16_t)(posf6 - (uint32_t)2U);
                        uint8_t *x0 = sl.base;
                        store16_be(x0, v_);
                        uint32_t len1 = (uint32_t)2U;
                        uint32_t uu____1 = (uint32_t)0U + len1;
                        scrut23 =
                          (
                            (LowParseWriters_iresult____){
                              .tag = LowParseWriters_ICorrect,
                              .val = { .case_ICorrect = posf6 }
                            }
                          );
                      }
                      else
                      {
                        scrut23 =
                          (
                            (LowParseWriters_iresult____){
                              .tag = LowParseWriters_IError,
                              .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                            }
                          );
                      }
                    }
                    else
                    {
                      scrut23 =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                  }
                  else
                  {
                    result____ scrut24 = { .tag = Correct };
                    result____ scrut;
                    if (scrut24.tag == Correct)
                    {
                      scrut = ((result____){ .tag = Correct });
                    }
                    else if (scrut24.tag == Error)
                    {
                      Prims_string e = scrut24._0;
                      scrut = ((result____){ .tag = Error, ._0 = e });
                    }
                    else
                    {
                      scrut =
                        KRML_EABORT(result____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                    if (scrut.tag == Correct)
                    {
                      scrut23 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_ICorrect,
                            .val = { .case_ICorrect = posf5 }
                          }
                        );
                    }
                    else if (scrut.tag == Error)
                    {
                      Prims_string e = scrut._0;
                      scrut23 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else
                    {
                      scrut23 =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                  }
                  if (scrut23.tag == LowParseWriters_IError)
                  {
                    Prims_string e = scrut23.val.case_IError;
                    return
                      (
                        (LowParseWriters_iresult____){
                          .tag = LowParseWriters_IError,
                          .val = { .case_IError = e }
                        }
                      );
                  }
                  else if (scrut23.tag == LowParseWriters_IOverflow)
                  {
                    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                  }
                  else if (scrut23.tag == LowParseWriters_ICorrect)
                  {
                    uint32_t posf6 = scrut23.val.case_ICorrect;
                    uint8_t *buf_0 = buf + posf6;
                    LowParseWriters_iresult____
                    scrut24 =
                      Negotiation_Writers_NoHoare_extract_write_pre_shared_key(lri,
                        now,
                        buf_0,
                        len - posf6,
                        (uint32_t)0U);
                    LowParseWriters_iresult____ scrut25;
                    if (scrut24.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut24.val.case_IError;
                      scrut25 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut24.tag == LowParseWriters_IOverflow)
                    {
                      scrut25 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut24.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t wlen = scrut24.val.case_ICorrect;
                      scrut25 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_ICorrect,
                            .val = { .case_ICorrect = posf6 + wlen }
                          }
                        );
                    }
                    else
                    {
                      scrut25 =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                    LowParseWriters_iresult____ scrut26;
                    if (scrut25.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut25.val.case_IError;
                      scrut26 =
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut25.tag == LowParseWriters_IOverflow)
                    {
                      scrut26 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut25.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t posf7 = scrut25.val.case_ICorrect;
                      LowParse_Slice_slice sl = { .base = buf, .len = len };
                      uint8_t *x00 = sl.base;
                      uint16_t r = load16_be(x00);
                      uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
                      uint32_t pos_pl = (uint32_t)2U;
                      uint32_t sz = posf7 - pos_pl;
                      if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
                      {
                        uint16_t v_ = (uint16_t)(posf7 - (uint32_t)2U);
                        uint8_t *x0 = sl.base;
                        store16_be(x0, v_);
                        uint32_t len1 = (uint32_t)2U;
                        uint32_t uu____2 = (uint32_t)0U + len1;
                        scrut26 =
                          (
                            (LowParseWriters_iresult____){
                              .tag = LowParseWriters_ICorrect,
                              .val = { .case_ICorrect = posf7 }
                            }
                          );
                      }
                      else
                      {
                        scrut26 =
                          (
                            (LowParseWriters_iresult____){
                              .tag = LowParseWriters_IError,
                              .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                            }
                          );
                      }
                    }
                    else
                    {
                      scrut26 =
                        KRML_EABORT(LowParseWriters_iresult____,
                          "unreachable (pattern matches are exhaustive in F*)");
                    }
                    if (scrut26.tag == LowParseWriters_IError)
                    {
                      Prims_string e = scrut26.val.case_IError;
                      return
                        (
                          (LowParseWriters_iresult____){
                            .tag = LowParseWriters_IError,
                            .val = { .case_IError = e }
                          }
                        );
                    }
                    else if (scrut26.tag == LowParseWriters_IOverflow)
                    {
                      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                    }
                    else if (scrut26.tag == LowParseWriters_ICorrect)
                    {
                      uint32_t posf7 = scrut26.val.case_ICorrect;
                      result____ scrut27 = { .tag = Correct };
                      result____ scrut;
                      if (scrut27.tag == Correct)
                      {
                        scrut = ((result____){ .tag = Correct });
                      }
                      else if (scrut27.tag == Error)
                      {
                        Prims_string e = scrut27._0;
                        scrut = ((result____){ .tag = Error, ._0 = e });
                      }
                      else
                      {
                        scrut =
                          KRML_EABORT(result____,
                            "unreachable (pattern matches are exhaustive in F*)");
                      }
                      if (scrut.tag == Correct)
                      {
                        return
                          (
                            (LowParseWriters_iresult____){
                              .tag = LowParseWriters_ICorrect,
                              .val = { .case_ICorrect = posf7 }
                            }
                          );
                      }
                      else if (scrut.tag == Error)
                      {
                        Prims_string e = scrut._0;
                        return
                          (
                            (LowParseWriters_iresult____){
                              .tag = LowParseWriters_IError,
                              .val = { .case_IError = e }
                            }
                          );
                      }
                      else
                      {
                        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                          __FILE__,
                          __LINE__,
                          "unreachable (pattern matches are exhaustive in F*)");
                        KRML_HOST_EXIT(255U);
                      }
                    }
                    else
                    {
                      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                        __FILE__,
                        __LINE__,
                        "unreachable (pattern matches are exhaustive in F*)");
                      KRML_HOST_EXIT(255U);
                    }
                  }
                  else
                  {
                    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                      __FILE__,
                      __LINE__,
                      "unreachable (pattern matches are exhaustive in F*)");
                    KRML_HOST_EXIT(255U);
                  }
                }
                else
                {
                  KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                    __FILE__,
                    __LINE__,
                    "unreachable (pattern matches are exhaustive in F*)");
                  KRML_HOST_EXIT(255U);
                }
              }
              else
              {
                uint8_t *buf_ = buf + posf4;
                LowParseWriters_iresult____
                scrut20 =
                  Negotiation_Writers_NoHoare_extract_write_psk_key_exchange_modes(buf_,
                    len - posf4,
                    (uint32_t)0U);
                LowParseWriters_iresult____ scrut;
                if (scrut20.tag == LowParseWriters_IError)
                {
                  Prims_string e = scrut20.val.case_IError;
                  scrut =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else if (scrut20.tag == LowParseWriters_IOverflow)
                {
                  scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                }
                else if (scrut20.tag == LowParseWriters_ICorrect)
                {
                  uint32_t wlen = scrut20.val.case_ICorrect;
                  scrut =
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_ICorrect,
                        .val = { .case_ICorrect = posf4 + wlen }
                      }
                    );
                }
                else
                {
                  scrut =
                    KRML_EABORT(LowParseWriters_iresult____,
                      "unreachable (pattern matches are exhaustive in F*)");
                }
                if (scrut.tag == LowParseWriters_IError)
                {
                  Prims_string e = scrut.val.case_IError;
                  return
                    (
                      (LowParseWriters_iresult____){
                        .tag = LowParseWriters_IError,
                        .val = { .case_IError = e }
                      }
                    );
                }
                else if (scrut.tag == LowParseWriters_IOverflow)
                {
                  return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
                }
                else if (scrut.tag == LowParseWriters_ICorrect)
                {
                  uint32_t posf5 = scrut.val.case_ICorrect;
                  LowParse_Slice_slice sl = { .base = buf, .len = len };
                  uint8_t *x00 = sl.base;
                  uint16_t r = load16_be(x00);
                  uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
                  uint32_t pos_pl = (uint32_t)2U;
                  uint32_t sz = posf5 - pos_pl;
                  if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
                  {
                    uint16_t v_ = (uint16_t)(posf5 - (uint32_t)2U);
                    uint8_t *x0 = sl.base;
                    store16_be(x0, v_);
                    uint32_t len1 = (uint32_t)2U;
                    uint32_t uu____3 = (uint32_t)0U + len1;
                    return
                      (
                        (LowParseWriters_iresult____){
                          .tag = LowParseWriters_ICorrect,
                          .val = { .case_ICorrect = posf5 }
                        }
                      );
                  }
                  else
                  {
                    return
                      (
                        (LowParseWriters_iresult____){
                          .tag = LowParseWriters_IError,
                          .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                        }
                      );
                  }
                }
                else
                {
                  KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                    __FILE__,
                    __LINE__,
                    "unreachable (pattern matches are exhaustive in F*)");
                  KRML_HOST_EXIT(255U);
                }
              }
            }
            else
            {
              KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
                __FILE__,
                __LINE__,
                "unreachable (pattern matches are exhaustive in F*)");
              KRML_HOST_EXIT(255U);
            }
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
        else
        {
          result____ scrut12 = { .tag = Correct };
          result____ scrut;
          if (scrut12.tag == Correct)
          {
            scrut = ((result____){ .tag = Correct });
          }
          else if (scrut12.tag == Error)
          {
            Prims_string e = scrut12._0;
            scrut = ((result____){ .tag = Error, ._0 = e });
          }
          else
          {
            scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut.tag == Correct)
          {
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf2 }
                }
              );
          }
          else if (scrut.tag == Error)
          {
            Prims_string e = scrut._0;
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct
__Parsers_ProtocolVersion_protocolVersion_FStar_Pervasives_Native_option__LowParseWriters_rptr_s
{
  Parsers_ProtocolVersion_protocolVersion fst;
  FStar_Pervasives_Native_option__LowParseWriters_rptr snd;
}
__Parsers_ProtocolVersion_protocolVersion_FStar_Pervasives_Native_option__LowParseWriters_rptr;

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_extract_keyshares(
  LowParseWriters_rptr cfg,
  FStar_Pervasives_Native_option__LowParseWriters_rptr ks,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  LowParse_Slice_slice sl0 = { .base = cfg.rptr_base, .len = cfg.rptr_len };
  uint32_t pos10 = Parsers_MiTLSConfig_accessor_miTLSConfig_max_version(sl0, (uint32_t)0U);
  uint32_t pos_ = Parsers_KnownProtocolVersion_knownProtocolVersion_jumper(sl0, pos10);
  uint8_t *b10 = cfg.rptr_base + pos10;
  uint32_t len_ = pos_ - pos10;
  uint8_t *b_ = b10;
  uint8_t *base_ = b_;
  uint32_t len_0 = len_;
  result__LowParseWriters_rptr
  scrut0 =
    { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_, .rptr_len = len_0 } } };
  result__LowParseWriters_rptr scrut1;
  if (scrut0.tag == Correct)
  {
    LowParseWriters_rptr x = scrut0.val.case_Correct;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut0.tag == Error)
  {
    Prims_string e = scrut0.val.case_Error;
    scrut1 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut1 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  result__LowParseWriters_rptr scrut2;
  if (scrut1.tag == Correct)
  {
    LowParseWriters_rptr x = scrut1.val.case_Correct;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x } });
  }
  else if (scrut1.tag == Error)
  {
    Prims_string e = scrut1.val.case_Error;
    scrut2 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
  }
  else
  {
    scrut2 =
      KRML_EABORT(result__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  iresult__LowParseWriters_rptr scrut3;
  if (scrut2.tag == Correct)
  {
    LowParseWriters_rptr res = scrut2.val.case_Correct;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = { .res = res, .new_pos = pos } }
        }
      );
  }
  else if (scrut2.tag == Error)
  {
    Prims_string e = scrut2.val.case_Error;
    scrut3 =
      (
        (iresult__LowParseWriters_rptr){
          .tag = LowParseWriters_IError,
          .val = { .case_IError = e }
        }
      );
  }
  else
  {
    scrut3 =
      KRML_EABORT(iresult__LowParseWriters_rptr,
        "unreachable (pattern matches are exhaustive in F*)");
  }
  if (scrut3.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut3.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut3.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut3.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut3.val.case_ICorrect.new_pos;
    LowParseWriters_rptr x = scrut3.val.case_ICorrect.res;
    LowParse_Slice_slice sl1 = { .base = x.rptr_base, .len = x.rptr_len };
    uint32_t
    pos1 = Parsers_KnownProtocolVersion_knownProtocolVersion_accessor_tag(sl1, (uint32_t)0U);
    uint32_t pos_0 = Parsers_ProtocolVersion_protocolVersion_jumper(sl1, pos1);
    uint8_t *b1 = x.rptr_base + pos1;
    uint32_t len_1 = pos_0 - pos1;
    uint8_t *b_0 = b1;
    uint8_t *base_0 = b_0;
    uint32_t len_2 = len_1;
    result__LowParseWriters_rptr
    scrut4 =
      { .tag = Correct, .val = { .case_Correct = { .rptr_base = base_0, .rptr_len = len_2 } } };
    result__LowParseWriters_rptr scrut5;
    if (scrut4.tag == Correct)
    {
      LowParseWriters_rptr x1 = scrut4.val.case_Correct;
      scrut5 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x1 } });
    }
    else if (scrut4.tag == Error)
    {
      Prims_string e = scrut4.val.case_Error;
      scrut5 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
    }
    else
    {
      scrut5 =
        KRML_EABORT(result__LowParseWriters_rptr,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    result__LowParseWriters_rptr scrut6;
    if (scrut5.tag == Correct)
    {
      LowParseWriters_rptr x1 = scrut5.val.case_Correct;
      scrut6 = ((result__LowParseWriters_rptr){ .tag = Correct, .val = { .case_Correct = x1 } });
    }
    else if (scrut5.tag == Error)
    {
      Prims_string e = scrut5.val.case_Error;
      scrut6 = ((result__LowParseWriters_rptr){ .tag = Error, .val = { .case_Error = e } });
    }
    else
    {
      scrut6 =
        KRML_EABORT(result__LowParseWriters_rptr,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    iresult__LowParseWriters_rptr scrut7;
    if (scrut6.tag == Correct)
    {
      LowParseWriters_rptr res = scrut6.val.case_Correct;
      scrut7 =
        (
          (iresult__LowParseWriters_rptr){
            .tag = LowParseWriters_ICorrect,
            .val = { .case_ICorrect = { .res = res, .new_pos = posf } }
          }
        );
    }
    else if (scrut6.tag == Error)
    {
      Prims_string e = scrut6.val.case_Error;
      scrut7 =
        (
          (iresult__LowParseWriters_rptr){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else
    {
      scrut7 =
        KRML_EABORT(iresult__LowParseWriters_rptr,
          "unreachable (pattern matches are exhaustive in F*)");
    }
    if (scrut7.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut7.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut7.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut7.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut7.val.case_ICorrect.new_pos;
      LowParseWriters_rptr x1 = scrut7.val.case_ICorrect.res;
      result__Parsers_ProtocolVersion_protocolVersion
      scrut8 =
        {
          .tag = Correct,
          .val = {
            .case_Correct = Parsers_ProtocolVersion_protocolVersion_reader((
                (LowParse_Slice_slice){ .base = x1.rptr_base, .len = x1.rptr_len }
              ),
              (uint32_t)0U)
          }
        };
      result__Parsers_ProtocolVersion_protocolVersion scrut9;
      if (scrut8.tag == Correct)
      {
        Parsers_ProtocolVersion_protocolVersion x2 = scrut8.val.case_Correct;
        scrut9 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Correct,
              .val = { .case_Correct = x2 }
            }
          );
      }
      else if (scrut8.tag == Error)
      {
        Prims_string e = scrut8.val.case_Error;
        scrut9 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Error,
              .val = { .case_Error = e }
            }
          );
      }
      else
      {
        scrut9 =
          KRML_EABORT(result__Parsers_ProtocolVersion_protocolVersion,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      result__Parsers_ProtocolVersion_protocolVersion scrut10;
      if (scrut9.tag == Correct)
      {
        Parsers_ProtocolVersion_protocolVersion x2 = scrut9.val.case_Correct;
        scrut10 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Correct,
              .val = { .case_Correct = x2 }
            }
          );
      }
      else if (scrut9.tag == Error)
      {
        Prims_string e = scrut9.val.case_Error;
        scrut10 =
          (
            (result__Parsers_ProtocolVersion_protocolVersion){
              .tag = Error,
              .val = { .case_Error = e }
            }
          );
      }
      else
      {
        scrut10 =
          KRML_EABORT(result__Parsers_ProtocolVersion_protocolVersion,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      iresult__Parsers_ProtocolVersion_protocolVersion scrut11;
      if (scrut10.tag == Correct)
      {
        Parsers_ProtocolVersion_protocolVersion res = scrut10.val.case_Correct;
        scrut11 =
          (
            (iresult__Parsers_ProtocolVersion_protocolVersion){
              .tag = LowParseWriters_ICorrect,
              .val = { .case_ICorrect = { .res = res, .new_pos = posf1 } }
            }
          );
      }
      else if (scrut10.tag == Error)
      {
        Prims_string e = scrut10.val.case_Error;
        scrut11 =
          (
            (iresult__Parsers_ProtocolVersion_protocolVersion){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else
      {
        scrut11 =
          KRML_EABORT(iresult__Parsers_ProtocolVersion_protocolVersion,
            "unreachable (pattern matches are exhaustive in F*)");
      }
      if (scrut11.tag == LowParseWriters_IError)
      {
        Prims_string e = scrut11.val.case_IError;
        return
          (
            (LowParseWriters_iresult____){
              .tag = LowParseWriters_IError,
              .val = { .case_IError = e }
            }
          );
      }
      else if (scrut11.tag == LowParseWriters_IOverflow)
      {
        return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
      }
      else if (scrut11.tag == LowParseWriters_ICorrect)
      {
        uint32_t posf2 = scrut11.val.case_ICorrect.new_pos;
        Parsers_ProtocolVersion_protocolVersion x2 = scrut11.val.case_ICorrect.res;
        __Parsers_ProtocolVersion_protocolVersion_FStar_Pervasives_Native_option__LowParseWriters_rptr
        scrut12 = { .fst = x2, .snd = ks };
        if
        (
          scrut12.fst.tag
          == Parsers_ProtocolVersion_TLS_1p3
          && scrut12.snd.tag == FStar_Pervasives_Native_Some
        )
        {
          LowParseWriters_rptr ks1 = scrut12.snd.v;
          uint8_t *buf_ = buf + posf2;
          uint8_t *b_1 = buf_;
          FStar_Pervasives_Native_option__uint32_t scrut13;
          if (len - posf2 - (uint32_t)0U < (uint32_t)2U)
          {
            scrut13 =
              ((FStar_Pervasives_Native_option__uint32_t){ .tag = FStar_Pervasives_Native_None });
          }
          else
          {
            scrut13 =
              (
                (FStar_Pervasives_Native_option__uint32_t){
                  .tag = FStar_Pervasives_Native_Some,
                  .v = Parsers_ExtensionType_extensionType_writer((
                      (Parsers_ExtensionType_extensionType){
                        .tag = Parsers_ExtensionType_Key_share
                      }
                    ),
                    ((LowParse_Slice_slice){ .base = b_1, .len = len - posf2 - (uint32_t)0U }),
                    (uint32_t)0U)
                }
              );
          }
          LowParseWriters_iresult____ scrut14;
          if (scrut13.tag == FStar_Pervasives_Native_None)
          {
            scrut14 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut13.tag == FStar_Pervasives_Native_Some)
          {
            uint32_t xlen = scrut13.v;
            scrut14 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = (uint32_t)0U + xlen }
                }
              );
          }
          else
          {
            scrut14 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          LowParseWriters_iresult____ scrut15;
          if (scrut14.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut14.val.case_IError;
            scrut15 =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut14.tag == LowParseWriters_IOverflow)
          {
            scrut15 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut14.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf3 = scrut14.val.case_ICorrect;
            uint8_t *buf_1 = buf_ + posf3;
            LowParseWriters_iresult____ scrut16;
            if (len - posf2 - posf3 < ks1.rptr_len)
            {
              scrut16 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else
            {
              memcpy(buf_1, ks1.rptr_base, ks1.rptr_len * sizeof (ks1.rptr_base[0U]));
              scrut16 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = ks1.rptr_len }
                  }
                );
            }
            LowParseWriters_iresult____ scrut;
            if (scrut16.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut16.val.case_IError;
              scrut =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut16.tag == LowParseWriters_IOverflow)
            {
              scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut16.tag == LowParseWriters_ICorrect)
            {
              uint32_t wlen = scrut16.val.case_ICorrect;
              scrut =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = posf3 + wlen }
                  }
                );
            }
            else
            {
              scrut =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
            if (scrut.tag == LowParseWriters_IError)
            {
              Prims_string e = scrut.val.case_IError;
              scrut15 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = e }
                  }
                );
            }
            else if (scrut.tag == LowParseWriters_IOverflow)
            {
              scrut15 = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
            }
            else if (scrut.tag == LowParseWriters_ICorrect)
            {
              uint32_t posf4 = scrut.val.case_ICorrect;
              scrut15 =
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = posf4 }
                  }
                );
            }
            else
            {
              scrut15 =
                KRML_EABORT(LowParseWriters_iresult____,
                  "unreachable (pattern matches are exhaustive in F*)");
            }
          }
          else
          {
            scrut15 =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          LowParseWriters_iresult____ scrut;
          if (scrut15.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut15.val.case_IError;
            scrut =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut15.tag == LowParseWriters_IOverflow)
          {
            scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut15.tag == LowParseWriters_ICorrect)
          {
            uint32_t wlen = scrut15.val.case_ICorrect;
            scrut =
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf2 + wlen }
                }
              );
          }
          else
          {
            scrut =
              KRML_EABORT(LowParseWriters_iresult____,
                "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut.tag == LowParseWriters_IError)
          {
            Prims_string e = scrut.val.case_IError;
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else if (scrut.tag == LowParseWriters_IOverflow)
          {
            return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
          }
          else if (scrut.tag == LowParseWriters_ICorrect)
          {
            uint32_t posf3 = scrut.val.case_ICorrect;
            LowParse_Slice_slice sl = { .base = buf, .len = len };
            uint8_t *x00 = sl.base;
            uint16_t r = load16_be(x00);
            uint32_t pos_last = (uint32_t)0U + (uint32_t)2U + (uint32_t)r;
            uint32_t pos_pl = (uint32_t)2U;
            uint32_t sz = posf3 - pos_pl;
            if ((uint32_t)0U <= sz && sz <= (uint32_t)65535U)
            {
              uint16_t v_ = (uint16_t)(posf3 - (uint32_t)2U);
              uint8_t *x0 = sl.base;
              store16_be(x0, v_);
              uint32_t len1 = (uint32_t)2U;
              uint32_t uu____0 = (uint32_t)0U + len1;
              return
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_ICorrect,
                    .val = { .case_ICorrect = posf3 }
                  }
                );
            }
            else
            {
              return
                (
                  (LowParseWriters_iresult____){
                    .tag = LowParseWriters_IError,
                    .val = { .case_IError = "parse_vllist_snoc_weak: out of bounds" }
                  }
                );
            }
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
        else
        {
          result____ scrut13 = { .tag = Correct };
          result____ scrut;
          if (scrut13.tag == Correct)
          {
            scrut = ((result____){ .tag = Correct });
          }
          else if (scrut13.tag == Error)
          {
            Prims_string e = scrut13._0;
            scrut = ((result____){ .tag = Error, ._0 = e });
          }
          else
          {
            scrut = KRML_EABORT(result____, "unreachable (pattern matches are exhaustive in F*)");
          }
          if (scrut.tag == Correct)
          {
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_ICorrect,
                  .val = { .case_ICorrect = posf2 }
                }
              );
          }
          else if (scrut.tag == Error)
          {
            Prims_string e = scrut._0;
            return
              (
                (LowParseWriters_iresult____){
                  .tag = LowParseWriters_IError,
                  .val = { .case_IError = e }
                }
              );
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

LowParseWriters_iresult____
Negotiation_Writers_NoHoare_write_extensions(
  LowParseWriters_rptr cfg,
  FStar_Pervasives_Native_option__LowParseWriters_rptr ks,
  bool edi,
  LowParseWriters_Parsers_rlptr lri,
  uint32_t now,
  uint8_t *buf,
  uint32_t len,
  uint32_t pos
)
{
  uint32_t pos_pl = (uint32_t)2U;
  LowParseWriters_iresult____ scrut;
  if (len < pos_pl)
  {
    scrut = ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else
  {
    LowParse_Slice_slice sl = { .base = buf, .len = len };
    uint16_t v_ = (uint16_t)(pos_pl - (uint32_t)2U);
    uint8_t *x0 = sl.base;
    store16_be(x0, v_);
    uint32_t len1 = (uint32_t)2U;
    uint32_t uu____0 = (uint32_t)0U + len1;
    scrut =
      (
        (LowParseWriters_iresult____){
          .tag = LowParseWriters_ICorrect,
          .val = { .case_ICorrect = pos_pl }
        }
      );
  }
  if (scrut.tag == LowParseWriters_IError)
  {
    Prims_string e = scrut.val.case_IError;
    return
      ((LowParseWriters_iresult____){ .tag = LowParseWriters_IError, .val = { .case_IError = e } });
  }
  else if (scrut.tag == LowParseWriters_IOverflow)
  {
    return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
  }
  else if (scrut.tag == LowParseWriters_ICorrect)
  {
    uint32_t posf = scrut.val.case_ICorrect;
    LowParseWriters_iresult____
    scrut0 = Negotiation_Writers_NoHoare_extract_keyshares(cfg, ks, buf, len, posf);
    if (scrut0.tag == LowParseWriters_IError)
    {
      Prims_string e = scrut0.val.case_IError;
      return
        (
          (LowParseWriters_iresult____){
            .tag = LowParseWriters_IError,
            .val = { .case_IError = e }
          }
        );
    }
    else if (scrut0.tag == LowParseWriters_IOverflow)
    {
      return ((LowParseWriters_iresult____){ .tag = LowParseWriters_IOverflow });
    }
    else if (scrut0.tag == LowParseWriters_ICorrect)
    {
      uint32_t posf1 = scrut0.val.case_ICorrect;
      return
        Negotiation_Writers_NoHoare_extract_write_final_extensions(cfg,
          edi,
          lri,
          now,
          buf,
          len,
          posf1);
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

